(function(){function require(name){var module=require.modules[name];if(!module)throw new Error('failed to require "'+name+'"');if(!("exports"in module)&&typeof module.definition==="function"){module.client=module.component=true;module.definition.call(this,module.exports={},module);delete module.definition}return module.exports}require.loader="component";require.helper={};require.helper.semVerSort=function(a,b){var aArray=a.version.split(".");var bArray=b.version.split(".");for(var i=0;i<aArray.length;++i){var aInt=parseInt(aArray[i],10);var bInt=parseInt(bArray[i],10);if(aInt===bInt){var aLex=aArray[i].substr((""+aInt).length);var bLex=bArray[i].substr((""+bInt).length);if(aLex===""&&bLex!=="")return 1;if(aLex!==""&&bLex==="")return-1;if(aLex!==""&&bLex!=="")return aLex>bLex?1:-1;continue}else if(aInt>bInt){return 1}else{return-1}}return 0};require.latest=function(name,returnPath){function showError(name){throw new Error('failed to find latest module of "'+name+'"')}var versionRegexp=/(.*)~(.*)@v?(\d+\.\d+\.\d+[^\/]*)$/;var remoteRegexp=/(.*)~(.*)/;if(!remoteRegexp.test(name))showError(name);var moduleNames=Object.keys(require.modules);var semVerCandidates=[];var otherCandidates=[];for(var i=0;i<moduleNames.length;i++){var moduleName=moduleNames[i];if(new RegExp(name+"@").test(moduleName)){var version=moduleName.substr(name.length+1);var semVerMatch=versionRegexp.exec(moduleName);if(semVerMatch!=null){semVerCandidates.push({version:version,name:moduleName})}else{otherCandidates.push({version:version,name:moduleName})}}}if(semVerCandidates.concat(otherCandidates).length===0){showError(name)}if(semVerCandidates.length>0){var module=semVerCandidates.sort(require.helper.semVerSort).pop().name;if(returnPath===true){return module}return require(module)}var module=otherCandidates.sort(function(a,b){return a.name>b.name})[0].name;if(returnPath===true){return module}return require(module)};require.modules={};require.register=function(name,definition){require.modules[name]={definition:definition}};require.define=function(name,exports){require.modules[name]={exports:exports}};require.register("component~ease@1.0.0",function(exports,module){exports.linear=function(n){return n};exports.inQuad=function(n){return n*n};exports.outQuad=function(n){return n*(2-n)};exports.inOutQuad=function(n){n*=2;if(n<1)return.5*n*n;return-.5*(--n*(n-2)-1)};exports.inCube=function(n){return n*n*n};exports.outCube=function(n){return--n*n*n+1};exports.inOutCube=function(n){n*=2;if(n<1)return.5*n*n*n;return.5*((n-=2)*n*n+2)};exports.inQuart=function(n){return n*n*n*n};exports.outQuart=function(n){return 1- --n*n*n*n};exports.inOutQuart=function(n){n*=2;if(n<1)return.5*n*n*n*n;return-.5*((n-=2)*n*n*n-2)};exports.inQuint=function(n){return n*n*n*n*n};exports.outQuint=function(n){return--n*n*n*n*n+1};exports.inOutQuint=function(n){n*=2;if(n<1)return.5*n*n*n*n*n;return.5*((n-=2)*n*n*n*n+2)};exports.inSine=function(n){return 1-Math.cos(n*Math.PI/2)};exports.outSine=function(n){return Math.sin(n*Math.PI/2)};exports.inOutSine=function(n){return.5*(1-Math.cos(Math.PI*n))};exports.inExpo=function(n){return 0==n?0:Math.pow(1024,n-1)};exports.outExpo=function(n){return 1==n?n:1-Math.pow(2,-10*n)};exports.inOutExpo=function(n){if(0==n)return 0;if(1==n)return 1;if((n*=2)<1)return.5*Math.pow(1024,n-1);return.5*(-Math.pow(2,-10*(n-1))+2)};exports.inCirc=function(n){return 1-Math.sqrt(1-n*n)};exports.outCirc=function(n){return Math.sqrt(1- --n*n)};exports.inOutCirc=function(n){n*=2;if(n<1)return-.5*(Math.sqrt(1-n*n)-1);return.5*(Math.sqrt(1-(n-=2)*n)+1)};exports.inBack=function(n){var s=1.70158;return n*n*((s+1)*n-s)};exports.outBack=function(n){var s=1.70158;return--n*n*((s+1)*n+s)+1};exports.inOutBack=function(n){var s=1.70158*1.525;if((n*=2)<1)return.5*(n*n*((s+1)*n-s));return.5*((n-=2)*n*((s+1)*n+s)+2)};exports.inBounce=function(n){return 1-exports.outBounce(1-n)};exports.outBounce=function(n){if(n<1/2.75){return 7.5625*n*n}else if(n<2/2.75){return 7.5625*(n-=1.5/2.75)*n+.75}else if(n<2.5/2.75){return 7.5625*(n-=2.25/2.75)*n+.9375}else{return 7.5625*(n-=2.625/2.75)*n+.984375}};exports.inOutBounce=function(n){if(n<.5)return exports.inBounce(n*2)*.5;return exports.outBounce(n*2-1)*.5+.5};exports["in-quad"]=exports.inQuad;exports["out-quad"]=exports.outQuad;exports["in-out-quad"]=exports.inOutQuad;exports["in-cube"]=exports.inCube;exports["out-cube"]=exports.outCube;exports["in-out-cube"]=exports.inOutCube;exports["in-quart"]=exports.inQuart;exports["out-quart"]=exports.outQuart;exports["in-out-quart"]=exports.inOutQuart;exports["in-quint"]=exports.inQuint;exports["out-quint"]=exports.outQuint;exports["in-out-quint"]=exports.inOutQuint;exports["in-sine"]=exports.inSine;exports["out-sine"]=exports.outSine;exports["in-out-sine"]=exports.inOutSine;exports["in-expo"]=exports.inExpo;exports["out-expo"]=exports.outExpo;exports["in-out-expo"]=exports.inOutExpo;exports["in-circ"]=exports.inCirc;exports["out-circ"]=exports.outCirc;exports["in-out-circ"]=exports.inOutCirc;exports["in-back"]=exports.inBack;exports["out-back"]=exports.outBack;exports["in-out-back"]=exports.inOutBack;exports["in-bounce"]=exports.inBounce;exports["out-bounce"]=exports.outBounce;exports["in-out-bounce"]=exports.inOutBounce});require.register("component~emitter@1.2.0",function(exports,module){module.exports=Emitter;function Emitter(obj){if(obj)return mixin(obj)}function mixin(obj){for(var key in Emitter.prototype){obj[key]=Emitter.prototype[key]}return obj}Emitter.prototype.on=Emitter.prototype.addEventListener=function(event,fn){this._callbacks=this._callbacks||{};(this._callbacks["$"+event]=this._callbacks["$"+event]||[]).push(fn);return this};Emitter.prototype.once=function(event,fn){function on(){this.off(event,on);fn.apply(this,arguments)}on.fn=fn;this.on(event,on);return this};Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(event,fn){this._callbacks=this._callbacks||{};if(0==arguments.length){this._callbacks={};return this}var callbacks=this._callbacks["$"+event];if(!callbacks)return this;if(1==arguments.length){delete this._callbacks["$"+event];return this}var cb;for(var i=0;i<callbacks.length;i++){cb=callbacks[i];if(cb===fn||cb.fn===fn){callbacks.splice(i,1);break}}return this};Emitter.prototype.emit=function(event){this._callbacks=this._callbacks||{};var args=[].slice.call(arguments,1),callbacks=this._callbacks["$"+event];if(callbacks){callbacks=callbacks.slice(0);for(var i=0,len=callbacks.length;i<len;++i){callbacks[i].apply(this,args)}}return this};Emitter.prototype.listeners=function(event){this._callbacks=this._callbacks||{};return this._callbacks["$"+event]||[]};Emitter.prototype.hasListeners=function(event){return!!this.listeners(event).length}});require.register("akirakazu~ika-animations@master",function(exports,module){module.exports.Animation=require("akirakazu~ika-animations@master/src/animation.js");module.exports.Ease=require("akirakazu~ika-animations@master/src/ease.js");module.exports.Friction=require("akirakazu~ika-animations@master/src/friction.js")});require.register("akirakazu~ika-animations@master/src/animation.js",function(exports,module){var Emitter=require("component~emitter@1.2.0");function Animation(){Emitter.call(this);this.isAnimating=false;this.startTime=0;this.totalTime=500}Animation.prototype=new Emitter;Animation.prototype.animate=function(){if(this.isAnimating){return}this.isAnimating=true;this.startTime=(new Date).getTime();if(NotificationReceiver){NotificationReceiver.emit("start-render",this.totalTime)}};Animation.prototype.step=function(){this.value-=5;this.emit("step");if(this.value<=0){this.stop()}};Animation.prototype.stop=function(){if(!this.isAnimating){return}this.isAnimating=false;this.startTime=0;this.emit("end")};Animation.prototype.abort=function(){if(!this.isAnimating){return}this.isAnimating=false;this.startTime=0};Animation.prototype.dispose=function(){this.stop()};module.exports=Animation});require.register("akirakazu~ika-animations@master/src/ease.js",function(exports,module){var ease=require("component~ease@1.0.0");var Animation=require("akirakazu~ika-animations@master/src/animation.js");function EaseAnimation(b,c,d,type){Animation.call(this);this.name="ease";this.b=b;this.c=c;this.d=d||500;this.type=type||"outExpo";this.value=b;this.totalTime=d}EaseAnimation.prototype=new Animation;EaseAnimation.prototype.step=function(){var b=this.b,c=this.c,d=this.d;var t=Date.now()-this.startTime;if(b==c){this.stop();return}if(t>=d){this.stop();return}if(c>b&&this.value>=c||c<b&&this.value<=c){this.stop();return}var p=t/d;var val=ease[this.type](p);this.value=b+(c-b)*val;this.emit("step",this.value)};module.exports=EaseAnimation});require.register("akirakazu~ika-animations@master/src/friction.js",function(exports,module){var Animation=require("akirakazu~ika-animations@master/src/animation.js");function FrictionAnimation(b,v0){Animation.call(this);this.name="friction";this.value=b;this.v0=v0;this.v=v0;if(this.v0>0){this.a=-.006}else{this.a=.006}this.totalTime=5e3}FrictionAnimation.prototype=new Animation;FrictionAnimation.prototype.step=function(){var lastTime=this.lastTime||this.startTime;var deltaTime=Date.now()-lastTime;this.lastTime=Date.now();var v=Math.abs(this.v)*this.a*deltaTime+this.v;if(v*this.v0<=0||Math.abs(v)<=.01){this.stop();return}this.v=v;this.value+=this.v*deltaTime;this.emit("step",this.value)};module.exports=FrictionAnimation});require.register("akirakazu~arraymgr@master",function(exports,module){var Emitter=require("component~emitter@1.2.0");var walkJson=require("akirakazu~arraymgr@master/walk_json.js");function ArrayMgr(items){Emitter.call(this);if(items&&Array.isArray(items)){this._items=items}else{this._items=[]}}ArrayMgr.prototype=new Emitter;ArrayMgr.prototype.length=function(){return this._items.length};ArrayMgr.prototype.add=function(item,silent){this._items.push(item);var self=this;if(typeof item.on==="function"){item.on("size-changed",function(){if(self.find(item)!==-1){self.emit("size-changed")}})}if(!silent){this.emit("add",{item:item,index:this.length()-1})}};ArrayMgr.prototype.prepend=function(item,slient){this._items.unshift(item);var self=this;if(typeof item.on==="function"){item.on("size-changed",function(){if(self.find(item)!==-1){self.emit("size-changed")}})}if(!slient){this.emit("prepend",{item:item,index:0})}};ArrayMgr.prototype.rm=function(item,silent){var index=this.find(item);if(index===-1){return}this._items.splice(index,1);if(!silent){this.emit("rm",{item:item,index:index})}};ArrayMgr.prototype.move=function(item,nindex,silent){var index=this.find(item);if(index===-1||index===nindex){return}this._items.splice(index,1);var r=this._items.splice(nindex);this._items.push(item);this._items=this._items.concat(r);if(!silent){this.emit("moveto",{item:item,index:nindex})}};ArrayMgr.prototype.iterate=function(fn){if(!fn){return}for(var i=0,len=this.length();i<len;i++){var result=fn(this._items[i],i);if(result){break}}};ArrayMgr.prototype.backIterate=function(fn){if(!fn){return}var i=this.length();while(i--){var result=fn(this._items[i],i);if(result){break}}};ArrayMgr.prototype.find=function(item){var index=-1;this.iterate(function(_item,_index){if(item===_item){index=_index;return true}});return index};ArrayMgr.prototype.query=function(qs){var self=this;var result;this.iterate(function(item){var hit=true;walkJson(qs,function(key,value,paths){var obj=item;while(paths.length!==0){var p=paths.shift();if(obj[p]==null){hit=false;return true}else{obj=obj[p]}}if(obj[key]==null){hit=false;return true}if(value instanceof RegExp){if(!value.test(obj[key])){hit=false;return true}}else if(typeof value==="string"||typeof value==="number"||typeof value==="boolean"){if(value!==obj[key]){hit=false;return true}}});if(hit){result=item;return true}});return result};ArrayMgr.prototype.empty=function(){for(var i=0,len=this._items.length;i<len;i++){this._items[i]=null}this._items=[]};ArrayMgr.prototype.get=function(index){return this._items[index]};ArrayMgr.prototype.set=function(index,item){if(this.length()>index){this._items[index]=item}};ArrayMgr.prototype.rmByIndex=function(index,silent){if(!this._items[index]){return}this._items.splice(index,1);if(!silent){this.emit("rm")}};ArrayMgr.prototype.dispose=function(){this.empty();this._items=null};module.exports=ArrayMgr});require.register("akirakazu~arraymgr@master/walk_json.js",function(exports,module){var isArray=Array.isArray;function walkJson(key,json,paths,fn){if(isArray(json)){var result=fn(key,json,paths);if(result){return}for(var i=0,len=json.length;i<len;i++){var _paths=paths.slice();_paths.push(key);walkJson(i,json[i],_paths,fn)}}else if(typeof json==="object"&&!(json instanceof RegExp)){var result=fn(key,json,paths);if(result){return}for(var k in json){var _paths=paths.slice();_paths.push(key);walkJson(k,json[k],_paths,fn)}}else{fn(key,json,paths)}}module.exports=function(json,fn){if(isArray(json)){for(var i=0,len=json.length;i<len;i++){walkJson(i,json[i],[],fn)}}else if(typeof json==="object"&&!(json instanceof RegExp)){for(var k in json){walkJson(k,json[k],[],fn)}}}});require.register("ika",function(exports,module){var klasses=require("ika/src/klasses.js");for(var k in klasses){module.exports[k]=klasses[k]}module.exports["ika-animations"]=require("akirakazu~ika-animations@master");module.exports.Emitter=require("component~emitter@1.2.0");var Emitter=require("component~emitter@1.2.0");window.NotificationReceiver=new Emitter;module.exports.easySetup=require("ika/src/easy_setup.js").easySetup;module.exports.bindScene=require("ika/src/easy_setup.js").bindScene;module.exports.createElementsFromXML=require("ika/src/parse_xml.js").createElementsFromXML;module.exports.PICTURES=require("ika/src/public_pictures.js")});require.register("ika/src/klasses.js",function(exports,module){module.exports.Scene=require("ika/src/scene.js");module.exports.Model=require("ika/src/model.js");module.exports.utils=require("ika/src/utils.js");module.exports.effects=require("ika/src/effects.js");module.exports.events=require("ika/src/event.js");module.exports.Monkey=require("ika/src/monkey.js");module.exports.Element=require("ika/src/element.js");module.exports.Textarea=require("ika/src/elements/textarea.js");module.exports.Button=require("ika/src/elements/button.js");module.exports.Switch=require("ika/src/elements/switch.js");module.exports.Label=require("ika/src/elements/label.js");module.exports.Picture=require("ika/src/elements/picture.js");module.exports.Slider=require("ika/src/elements/slider.js");module.exports.Circle=require("ika/src/elements/circle.js");module.exports.Path=require("ika/src/elements/path.js");module.exports.Input=require("ika/src/elements/input.js");module.exports.Sprite=require("ika/src/elements/sprite.js");module.exports.Combobox=require("ika/src/elements/combobox.js");module.exports.Progress=require("ika/src/elements/progress.js");module.exports.Group=require("ika/src/group.js");module.exports.Scrollbase=require("ika/src/groups/scrollbase.js");module.exports.Listbase=require("ika/src/groups/listbase.js");module.exports.Swipe=require("ika/src/groups/swipe.js");module.exports.Buttonset=require("ika/src/groups/buttonset.js");module.exports.Stack=require("ika/src/groups/stack.js");module.exports.Fan=require("ika/src/groups/fan.js");module.exports.Menu=require("ika/src/groups/menu.js")});require.register("ika/src/utils.js",function(exports,module){var lastTime=0;var vendors=["ms","moz","webkit","o"];for(var x=0;x<vendors.length&&!window.requestAnimationFrame;++x){window.requestAnimationFrame=window[vendors[x]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[vendors[x]+"CancelAnimationFrame"]||window[vendors[x]+"CancelRequestAnimationFrame"]}if(window.requestAnimationFrame===undefined){window.requestAnimationFrame=function(callback){var currTime=Date.now(),timeToCall=Math.max(0,16-(currTime-lastTime));var id=window.setTimeout(function(){callback(currTime+timeToCall)},timeToCall);lastTime=currTime+timeToCall;return id}}if(window.cancelAnimationFrame===undefined){window.cancelAnimationFrame=function(id){clearTimeout(id)}}module.exports.colorOne="rgb(50,50,50)";module.exports.colorTwo="white";module.exports.colorThree="#eaeaea";module.exports.isPointInRect=function(x,y,x1,y1,width,height){return x>=x1&&x<=x1+width&&y>=y1&&y<=y1+height};module.exports.random=function(from,to,no_floor){if(Array.isArray(from)){return from[Math.floor(Math.random()*from.length)]}var _from=from==null?0:from,_to=to==null?0:to;if(to<from){_from=to;_to=from}else if(to==from){_to=_from+10}if(no_floor){return Math.random()*(_to-_from)+_from}else{return Math.floor(Math.random()*(_to-_from)+_from)}};module.exports.draggable=function(item,disableX,disableY){item.on("mousedown",function(e){this._on_dragging=true;if(!disableX){this._originalX=this.x;this._startDraggingX=e.x}if(!disableY){this._originalY=this.y;this._startDraggingY=e.y}});item.on("mousedrag",function(e){if(!this._on_dragging){return}if(!disableX){this.x=this._originalX+e.x-this._startDraggingX}if(!disableY){this.y=this._originalY+e.y-this._startDraggingY}});item.on("mousedragend",function(){this._on_dragging=false})};module.exports.elastic=function(item){item.on("mousedown",function(e){this._on_dragging=true;this._originalX=this.x;this._originalY=this.y;this._startDraggingX=e.x;this._startDraggingY=e.y});item.on("mousedrag",function(e){if(!this._on_dragging){return}this.x=this._originalX+(e.x-this._startDraggingX)/2;this.y=this._originalY+(e.y-this._startDraggingY)/2});item.on("mousedragend",function(){this.animateTo(this._originalX,this._originalY);this._on_dragging=false})};module.exports.centralize=function(scene,item){var b=item.getBound();item.x=(scene.width-b.width)/2;item.y=(scene.height-b.height)/2};module.exports.delegate=function(agent,func){return function(){return agent[func].apply(agent,arguments)}};module.exports.haveIntersection=function(a,b){var a1x=a.x;var a2x=a.x+a.width;var a1y=a.y;var a2y=a.y+a.height;var b1x=b.x;var b2x=b.x+b.width;var b1y=b.y;var b2y=b.y+b.height;return a1x<=b2x&&a2x>=b1x&&a1y<=b2y&&a2y>=b1y};function searchItemInGroup(group,item){var found=false;var pos={x:0,y:0};if(group.name==="Scrollbase"){pos.x+=group.offsetX;pos.y+=group.offsetY}group.children.iterate(function(_item){if(_item===item){found=true;return true}});if(found){var b=item.getBound();pos.x+=b.x;pos.y+=b.y;return pos}group.children.iterate(function(_item){if(_item.children){var b=_item.getBound();pos.x+=b.x;pos.y+=b.y;var result=searchItemInGroup(_item,item);if(result){found=true;pos.x+=result.x;pos.y+=result.y;return true}else{pos.x-=b.x;pos.y-=b.y}}});if(found){return pos}else{return null}}module.exports.searchItemInGroup=searchItemInGroup;module.exports.lorem="Lorem ipsum dolor sit amet, consectetur adipisicing elit, "+"sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. "+"Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi "+"ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit "+"in voluptate velit esse cillum dolore eu fugiat nulla pariatur. "+"Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia "+"deserunt mollit anim id est laborum. At vero eos et accusamus et iusto odio "+"dignissimos ducimus, qui blanditiis praesentium voluptatum deleniti atque corrupti, "+"quos dolores et quas molestias excepturi sint, obcaecati cupiditate "+"non provident, similique sunt in culpa, qui officia deserunt mollitia "+"animi, id est laborum et dolorum fuga. Et harum quidem rerum facilis "+"est et expedita distinctio. Nam libero tempore, cum soluta nobis est "+"eligendi optio, cumque nihil impedit, quo minus id, quod maxime placeat, "+"facere possimus, omnis voluptas assumenda est, omnis dolor repellendus.";module.exports.parseXML=function(data){var xml,tmp;if(!data||typeof data!=="string"){return null}try{if(window.DOMParser){tmp=new DOMParser;xml=tmp.parseFromString(data,"text/xml")}else{xml=new ActiveXObject("Microsoft.XMLDOM");xml.async="false";xml.loadXML(data)}}catch(e){xml=undefined}if(!xml||!xml.documentElement||xml.getElementsByTagName("parsererror").length){console.error("Invalid XML: "+data)}return xml}});require.register("ika/src/scene.js",function(exports,module){var Emitter=require("component~emitter@1.2.0");var EventDelegate=require("ika/src/event.js").EventDelegate;var Event=require("ika/src/event.js").Event;var utils=require("ika/src/utils.js");var ArrayMgr=require("akirakazu~arraymgr@master");var Query=require("ika/src/query.js");var Popover=require("ika/src/groups/popover.js");var Circle=require("ika/src/elements/circle.js");var Group=require("ika/src/group.js");function Scene(w,h,el){Emitter.call(this);if(w==null||h==null||el==null){console.log("missing arguments");return}var ctx=el.getContext("2d");ctx.imageSmoothingEnabled=false;ctx.mozImageSmoothingEnabled=false;ctx.webkitImageSmoothingEnabled=false;this.el=el;this.ctx=ctx;this.resize(w,h);this.backgroundColor="white";this._downPoint=null;this.enableFinger=false}Scene.prototype=new Emitter;Scene.prototype.resize=function(w,h){this.width=w;this.height=h;var el=this.el;var ctx=this.ctx;el.width=w;el.height=h;el.style.width=w+"px";el.style.height=h+"px";if(window.devicePixelRatio){el.width*=window.devicePixelRatio;el.height*=window.devicePixelRatio;ctx.scale(window.devicePixelRatio,window.devicePixelRatio)}};Scene.prototype.init=function(){this.children=new ArrayMgr;this._ed=new EventDelegate(this).init();this._popover=(new Popover).init().attr("visible",false);this._popover.on("should-hide",utils.delegate(this,"hidePopover"));this.children.add(this._popover);this._createFinger();return this};Scene.prototype._createFinger=function(){var finger=(new Group).init().attr("visible",false);var circle1=(new Circle).init().attr({radius:20}).css({"background-color":"rgba(255,255,255,0.5)","box-shadow-color":"rgba(0,0,0,0.5)","box-shadow-blur":3});finger.add(circle1);var circle2=(new Circle).init().attr("radius",17).css({"background-color":"rgba(255,255,255,0.7)"});finger.add(circle2);var circle3=(new Circle).init().attr("radius",14).css({"background-color":"rgba(255,255,255,1)"});finger.add(circle3);this._finger=finger};Scene.prototype.add=function(item){this.children.add(item)};Scene.prototype.addToBottom=function(item){this.add(item);this.children.move(item,0)};Scene.prototype.rm=function(item){this.children.rm(item)};Scene.prototype.moveToFront=function(item){this.children.move(item,this.children.length()-1)};Scene.prototype.render=function(){this.clear();var self=this;var rerender=false;this.children.iterate(function(item){item._updateAnimation();if(!item.visible){return}if(item.render(self.ctx)){rerender=true}});if(this.enableFinger&&this._finger.visible){this._finger.render(this.ctx)}if(rerender){this.render()}};Scene.prototype.clear=function(){var ctx=this.ctx;var w=this.width;var h=this.height;ctx.clearRect(0,0,w,h);ctx.save();ctx.fillStyle=this.backgroundColor;ctx.fillRect(0,0,w,h);ctx.restore()};Scene.prototype.hitTest=function(x,y,emitHitBackgroundEvent){var self=this;var item;this.children.backIterate(function(_item){if(!_item.visible){return}if(item=_item.hitTest(x,y,self.ctx)){return true}});if(emitHitBackgroundEvent&&!item){this.emit("hit-background")}return item};Scene.prototype._trigger_mousedown=function(event){if(this.enableFinger){this._finger.attr({x:event.x,y:event.y,visible:true})}NotificationReceiver.emit("start-render");this.emit("mousedown",event);this._downPoint={x:event.x,y:event.y};var item=this.hitTest(event.x,event.y,true);this.mouseTarget=item;item&&item.emit("mousedown",event,this.ctx)};Scene.prototype._trigger_mouseup=function(event){if(this.enableFinger){this._finger.attr("visible",false)}this.emit("mouseup",event);if(!this._downPoint){return}var item=this.hitTest(event.x,event.y);item&&item.emit("mouseup",event,this.ctx);if(this.mouseTarget&&this._isDragging){var event_dragend=new Event("mousedragend",event.x,event.y);this.mouseTarget.emit("mousedragend",event_dragend,this.ctx);this.mouseTarget=null}var x1=this._downPoint.x;var y1=this._downPoint.y;var x2=event.x;var y2=event.y;if(Math.sqrt((x1-x2)*(x1-x2)+(y1-y2)*(y1-y2))<=10){var event_click=new Event("click",event.x,event.y);item&&item.emit("click",event_click,this.ctx)}this._isDragging=false;this._downPoint=null;this.render()};Scene.prototype._trigger_mousemove=function(event){this.emit("mousemove",event);if(this.enableFinger){this._finger.attr({x:event.x,y:event.y})}if(this._downPoint){this._isDragging=true}var item=this.hitTest(event.x,event.y);item&&item.emit("mousemove",event,this.ctx);if(this.mouseTarget){var event_drag=new Event("mousedrag",event.x,event.y);this.mouseTarget.emit("mousedrag",event_drag,this.ctx)}};Scene.prototype._trigger_mousewheel=function(event){this.emit("mousewheel",event);var item=this.hitTest(event.x,event.y);item&&item.emit("mousewheel",event,this.ctx)};Scene.prototype.getChildPosition=function(item){return utils.searchItemInGroup(this,item)};Scene.prototype.query=function(selector){return new Query(this,selector)};Scene.prototype.getElementById=function(id,parent){id=id.replace("#","");var item;if(parent==null){parent=this}var self=this;parent.children.iterate(function(_item){if(_item.id===id){item=_item;return true}if(_item.children){var result=self.getElementById(id,_item);if(result){item=result;return true}}});return item};Scene.prototype.showPopover=function(item,x,y){if(this._popover.visible){return}this.moveToFront(this._popover);if(x!=null&&y!=null){this._popover.attr({x:x,y:y})}this._popover.add(item);this._popover.visible=true;this.render()};Scene.prototype.hidePopover=function(){this._popover.children.empty();this._popover.visible=false;this.render()};module.exports=Scene});require.register("ika/src/effects.js",function(exports,module){var mul_table=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259];var shg_table=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function BlurStack(){this.r=0;this.g=0;this.b=0;this.a=0;this.next=null}function blurImageData(imageData,width,height,radius){if(isNaN(radius)||radius<1)return;radius|=0;var pixels=imageData.data;var x,y,i,p,yp,yi,yw,r_sum,g_sum,b_sum,a_sum,r_out_sum,g_out_sum,b_out_sum,a_out_sum,r_in_sum,g_in_sum,b_in_sum,a_in_sum,pr,pg,pb,pa,rbs;var div=radius+radius+1;var w4=width<<2;var widthMinus1=width-1;var heightMinus1=height-1;var radiusPlus1=radius+1;var sumFactor=radiusPlus1*(radiusPlus1+1)/2;var stackStart=new BlurStack;var stack=stackStart;for(i=1;i<div;i++){stack=stack.next=new BlurStack;if(i==radiusPlus1)var stackEnd=stack}stack.next=stackStart;var stackIn=null;var stackOut=null;yw=yi=0;var mul_sum=mul_table[radius];var shg_sum=shg_table[radius];for(y=0;y<height;y++){r_in_sum=g_in_sum=b_in_sum=a_in_sum=r_sum=g_sum=b_sum=a_sum=0;r_out_sum=radiusPlus1*(pr=pixels[yi]);g_out_sum=radiusPlus1*(pg=pixels[yi+1]);b_out_sum=radiusPlus1*(pb=pixels[yi+2]);a_out_sum=radiusPlus1*(pa=pixels[yi+3]);r_sum+=sumFactor*pr;g_sum+=sumFactor*pg;b_sum+=sumFactor*pb;a_sum+=sumFactor*pa;stack=stackStart;for(i=0;i<radiusPlus1;i++){stack.r=pr;stack.g=pg;stack.b=pb;stack.a=pa;stack=stack.next}for(i=1;i<radiusPlus1;i++){p=yi+((widthMinus1<i?widthMinus1:i)<<2);r_sum+=(stack.r=pr=pixels[p])*(rbs=radiusPlus1-i);g_sum+=(stack.g=pg=pixels[p+1])*rbs;b_sum+=(stack.b=pb=pixels[p+2])*rbs;a_sum+=(stack.a=pa=pixels[p+3])*rbs;r_in_sum+=pr;g_in_sum+=pg;b_in_sum+=pb;a_in_sum+=pa;stack=stack.next}stackIn=stackStart;stackOut=stackEnd;for(x=0;x<width;x++){pixels[yi+3]=pa=a_sum*mul_sum>>shg_sum;if(pa!=0){pa=255/pa;pixels[yi]=(r_sum*mul_sum>>shg_sum)*pa;pixels[yi+1]=(g_sum*mul_sum>>shg_sum)*pa;pixels[yi+2]=(b_sum*mul_sum>>shg_sum)*pa}else{pixels[yi]=pixels[yi+1]=pixels[yi+2]=0}r_sum-=r_out_sum;g_sum-=g_out_sum;b_sum-=b_out_sum;a_sum-=a_out_sum;r_out_sum-=stackIn.r;g_out_sum-=stackIn.g;b_out_sum-=stackIn.b;a_out_sum-=stackIn.a;p=yw+((p=x+radius+1)<widthMinus1?p:widthMinus1)<<2;r_in_sum+=stackIn.r=pixels[p];g_in_sum+=stackIn.g=pixels[p+1];b_in_sum+=stackIn.b=pixels[p+2];a_in_sum+=stackIn.a=pixels[p+3];r_sum+=r_in_sum;g_sum+=g_in_sum;b_sum+=b_in_sum;a_sum+=a_in_sum;stackIn=stackIn.next;r_out_sum+=pr=stackOut.r;g_out_sum+=pg=stackOut.g;b_out_sum+=pb=stackOut.b;a_out_sum+=pa=stackOut.a;r_in_sum-=pr;g_in_sum-=pg;b_in_sum-=pb;a_in_sum-=pa;stackOut=stackOut.next;yi+=4}yw+=width}for(x=0;x<width;x++){g_in_sum=b_in_sum=a_in_sum=r_in_sum=g_sum=b_sum=a_sum=r_sum=0;yi=x<<2;r_out_sum=radiusPlus1*(pr=pixels[yi]);g_out_sum=radiusPlus1*(pg=pixels[yi+1]);b_out_sum=radiusPlus1*(pb=pixels[yi+2]);a_out_sum=radiusPlus1*(pa=pixels[yi+3]);r_sum+=sumFactor*pr;g_sum+=sumFactor*pg;b_sum+=sumFactor*pb;a_sum+=sumFactor*pa;stack=stackStart;for(i=0;i<radiusPlus1;i++){stack.r=pr;stack.g=pg;stack.b=pb;stack.a=pa;stack=stack.next}yp=width;for(i=1;i<=radius;i++){yi=yp+x<<2;r_sum+=(stack.r=pr=pixels[yi])*(rbs=radiusPlus1-i);g_sum+=(stack.g=pg=pixels[yi+1])*rbs;b_sum+=(stack.b=pb=pixels[yi+2])*rbs;a_sum+=(stack.a=pa=pixels[yi+3])*rbs;r_in_sum+=pr;g_in_sum+=pg;b_in_sum+=pb;a_in_sum+=pa;stack=stack.next;if(i<heightMinus1){yp+=width}}yi=x;stackIn=stackStart;stackOut=stackEnd;for(y=0;y<height;y++){p=yi<<2;pixels[p+3]=pa=a_sum*mul_sum>>shg_sum;if(pa>0){pa=255/pa;pixels[p]=(r_sum*mul_sum>>shg_sum)*pa;pixels[p+1]=(g_sum*mul_sum>>shg_sum)*pa;pixels[p+2]=(b_sum*mul_sum>>shg_sum)*pa}else{pixels[p]=pixels[p+1]=pixels[p+2]=0}r_sum-=r_out_sum;g_sum-=g_out_sum;b_sum-=b_out_sum;a_sum-=a_out_sum;r_out_sum-=stackIn.r;g_out_sum-=stackIn.g;b_out_sum-=stackIn.b;a_out_sum-=stackIn.a;p=x+((p=y+radiusPlus1)<heightMinus1?p:heightMinus1)*width<<2;r_sum+=r_in_sum+=stackIn.r=pixels[p];g_sum+=g_in_sum+=stackIn.g=pixels[p+1];b_sum+=b_in_sum+=stackIn.b=pixels[p+2];a_sum+=a_in_sum+=stackIn.a=pixels[p+3];stackIn=stackIn.next;r_out_sum+=pr=stackOut.r;g_out_sum+=pg=stackOut.g;b_out_sum+=pb=stackOut.b;a_out_sum+=pa=stackOut.a;r_in_sum-=pr;g_in_sum-=pg;b_in_sum-=pb;a_in_sum-=pa;stackOut=stackOut.next;yi+=width}}return imageData}function clamp(val,min,max){return Math.min(max,Math.max(min,val))}function gaussian(data,width,height,kernelSize){var r,g,b,a,idx,x,y,i,j,inx,iny,w,tmpData=[],maxKernelSize=13,kernelSize=clamp(kernelSize,3,maxKernelSize),k1=-kernelSize/2+(kernelSize%2?.5:0),k2=kernelSize+k1,weights,kernels=[[1]];for(i=1;i<maxKernelSize;++i){kernels[0][i]=0}for(i=1;i<maxKernelSize;++i){
kernels[i]=[1];for(j=1;j<maxKernelSize;++j){kernels[i][j]=kernels[i-1][j]+kernels[i-1][j-1]}}weights=kernels[kernelSize-1];for(i=0,w=0;i<kernelSize;++i){w+=weights[i]}for(i=0;i<kernelSize;++i){weights[i]/=w}for(y=0;y<height;++y){for(x=0;x<width;++x){r=g=b=a=0;for(i=k1;i<k2;++i){inx=x+i;iny=y;w=weights[i-k1];if(inx<0){inx=0}if(inx>=width){inx=width-1}idx=(iny*width+inx)*4;r+=data[idx]*w;g+=data[idx+1]*w;b+=data[idx+2]*w;a+=data[idx+3]*w}idx=(y*width+x)*4;tmpData[idx]=r;tmpData[idx+1]=g;tmpData[idx+2]=b;tmpData[idx+3]=a}}for(y=0;y<height;++y){for(x=0;x<width;++x){r=g=b=a=0;for(i=k1;i<k2;++i){inx=x;iny=y+i;w=weights[i-k1];if(iny<0){iny=0}if(iny>=height){iny=height-1}idx=(iny*width+inx)*4;r+=tmpData[idx]*w;g+=tmpData[idx+1]*w;b+=tmpData[idx+2]*w;a+=tmpData[idx+3]*w}idx=(y*width+x)*4;data[idx]=r;data[idx+1]=g;data[idx+2]=b;data[idx+3]=a}}return data}function cloneArray(arr){var _arr=[];for(var i=0,len=arr.length;i<len;i++){_arr[i]=arr[i]}return _arr}module.exports={flipv:function(data,height,width){var inPix,outPix,x,y;for(y=0;y<height;++y){for(x=0;x<width;++x){inPix=(y*width+x)*4;outPix=(y*width+(width-x-1))*4;data[outPix]=data[inPix];data[outPix+1]=data[inPix+1];data[outPix+2]=data[inPix+2];data[outPix+3]=data[inPix+3]}}},fliph:function(data,height,width){var inPix,outPix,x,y;for(y=0;y<height;++y){for(x=0;x<width;++x){inPix=(y*width+x)*4;outPix=((height-y-1)*width+x)*4;data[outPix]=data[inPix];data[outPix+1]=data[inPix+1];data[outPix+2]=data[inPix+2];data[outPix+3]=data[inPix+3]}}},invert:function(data){for(var i=0;i<data.length;i+=4){data[i]=255-data[i];data[i+1]=255-data[i+1];data[i+2]=255-data[i+2];data[i+3]=data[i+3]}},sepia:function(data){var r,g,b;for(var i=0;i<data.length;i+=4){r=data[i];g=data[i+1];b=data[i+2];data[i]=r*.393+g*.769+b*.189;data[i+1]=r*.349+g*.686+b*.168;data[i+2]=r*.272+g*.534+b*.131}},solarize:function(data){var r,g,b;for(var i=0;i<data.length;i+=4){r=data[i];g=data[i+1];b=data[i+2];data[i]=r>127?255-r:r;data[i+1]=g>127?255-g:g;data[i+2]=b>127?255-b:b}},brightness:function(data){var brightness=1;var contrast=0;var r,g,b;contrast=clamp(contrast,-1,1)/2;brightness=1+clamp(brightness,-1,1);var brightMul=brightness<0?-brightness:brightness;var brightAdd=brightness<0?0:brightness;contrast=.5*Math.tan((contrast+1)*Math.PI/4);contrastAdd=-(contrast-.5)*255;for(var i=0;i<data.length;i+=4){r=data[i];g=data[i+1];b=data[i+2];r=(r+r*brightMul+brightAdd)*contrast+contrastAdd;g=(g+g*brightMul+brightAdd)*contrast+contrastAdd;b=(b+b*brightMul+brightAdd)*contrast+contrastAdd;data[i]=r;data[i+1]=g;data[i+2]=b}},desaturate:function(data){var level;for(var i=0;i<data.length;i+=4){level=data[i]*.3+data[i+1]*.59+data[i+2]*.11;data[i]=level;data[i+1]=level;data[i+2]=level}},blur:function(data,width,height,kernelSize){kernelSize=kernelSize||10;gaussian(data,width,height,kernelSize)},mosaic:function(data,width,height){var blockLength=10;var pixelCounts=blockLength*blockLength;var xBlockCount=width/blockLength;var yBlockCount=height/blockLength;for(var x=0;x<xBlockCount;x+=1){for(var y=0;y<yBlockCount;y+=1){var sum=[0,0,0];var lenX=(x+1)*blockLength;var lenY=(y+1)*blockLength;for(var _x=x*blockLength;_x<lenX;_x+=1){for(var _y=y*blockLength;_y<lenY;_y+=1){sum[0]+=data[(_y*width+_x)*4];sum[1]+=data[(_y*width+_x)*4+1];sum[2]+=data[(_y*width+_x)*4+2]}}sum[0]/=pixelCounts;sum[1]/=pixelCounts;sum[2]/=pixelCounts;for(var _x=x*blockLength;_x<lenX;_x+=1){for(var _y=y*blockLength;_y<lenY;_y+=1){data[(_y*width+_x)*4]=sum[0];data[(_y*width+_x)*4+1]=sum[1];data[(_y*width+_x)*4+2]=sum[2]}}}}}}});require.register("ika/src/query.js",function(exports,module){var ArrayMgr=require("akirakazu~arraymgr@master");function isNumber(d){if(/-?^\d+$/g.test(d)){return true}}function Query(scene,selector){this.target=scene;selector=selector.replace(/[\ \t]+/g," ");var tokens=selector.split(" ");this.tokens=tokens;this.token_index=0;this.results=new ArrayMgr;this._search()}Query.prototype._search=function(){if(!this.target.children||this.target.children.length()===0){return}var token=this.tokens[this.token_index];var tagName=token.split("?")[0];var _queries={},queries;var query=token.split("?")[1];if(query){queries=query.split("&")}if(queries&&queries.length!==0&&queries[0]!==""){for(var i=0;i<queries.length;i++){var key=queries[i].split("=")[0];var value=queries[i].split("=")[1]||true;if(isNumber(value)){value=parseInt(value,10)}if(value==="true"){value=true}if(value==="false"){value=false}_queries[key]=value}}var self=this;var target=this.target;target.children.iterate(function(item,index){if(item.name.toLowerCase()===tagName||tagName===""){var flag=true;for(var k in _queries){if(item.attr(k)!==_queries[k]){flag=false;break}}if(flag){if(self.token_index===self.tokens.length-1){self.results.add(item)}else{self.target=item;self.token_index++;self._search();self.target=target;self.token_index--}}}})};Query.prototype.css=function(key,val){if(val==null){var results=[];this.results.iterate(function(r){results.push(r.css(key))});return results}else{this.results.iterate(function(r){r.css(key,val)});return this}};Query.prototype.attr=function(key,val){if(val==null){var results=[];this.results.iterate(function(r){results.push(r.attr(key))});return results}else{this.results.iterate(function(r){r.attr(key,val)});return this}};Query.prototype.each=function(fn){this.results.iterate(fn)};Query.prototype.length=function(){return this.results.length()};Query.prototype.dispose=function(){this.results.empty();this.results=null};Query.prototype.get=function(index){return this.results.get(index)};module.exports=Query});require.register("ika/src/monkey.js",function(exports,module){var Event=require("ika/src/event.js").Event;var Emitter=require("component~emitter@1.2.0");function Monkey(scene){Emitter.call(this);this.scene=scene;this.actions=[];this.interval=2e3}Monkey.prototype=new Emitter;Monkey.prototype.down=function(x,y,t){this.actions.push({name:"mousedown",event:new Event("mousedown",x,y),time:t||this.interval})};Monkey.prototype.up=function(x,y,t){this.actions.push({name:"mouseup",event:new Event("mouseup",x,y),time:t||this.interval})};Monkey.prototype.wheel=function(x,y,dx,dy,t){var e=new Event("mousewheel",x,y);e.wheelDeltaX=dx;e.wheelDeltaY=dy;this.actions.push({name:"mousewheel",event:e,time:t||this.interval})};Monkey.prototype.swipe=function(x1,y1,x2,y2,t,delay){t=t||this.interval;var delta=15;this.down(x1,y1,delay||300);for(var i=1;i<=t/delta;i++){var x=x1+i*(x2-x1)/(t/delta);var y=y1+i*(y2-y1)/(t/delta);var e=new Event("mousemove",x,y);this.actions.push({name:"mousemove",event:e,time:delta})}this.up(x2,y2,300)};Monkey.prototype.click=function(obj,delay){var pos=this.scene.getChildPosition(obj);var b=obj.getBound();this.down(pos.x+b.width/2,pos.y+b.height/2,delay);this.up(pos.x+b.width/2,pos.y+b.height/2,300)};Monkey.prototype.input=function(value,t){this.actions.push({name:"input",value:value,time:t||this.interval})};Monkey.prototype._step=function(index){var data=this.actions[index];if(!data){this.stop();this.emit("stop");return}var self=this;setTimeout(function(){if(data.name==="input"){if(NotificationReceiver.input){NotificationReceiver.input.value=data.value}}else{self.scene["_trigger_"+data.name](data.event)}self._step(index+1)},data.time)};Monkey.prototype.run=function(){if(this.isReplaying){this.emit("stop");return}if(this.actions.length===0){this.emit("stop");return}this._step(0);this.isReplaying=true};Monkey.prototype.stop=function(){this.isReplaying=false};module.exports=Monkey});require.register("ika/src/event.js",function(exports,module){var utils=require("ika/src/utils.js");function Event(eventName,x,y){this.eventName=eventName;this.x=x||0;this.y=y||0}Event.prototype.clone=function(){var ne=new Event(this.eventName,this.x,this.y);var keys=["wheelDeltaX","wheelDeltaY","keyCode","keyName","touches"];for(var i=0;i<keys.length;i++){var key=keys[i];if(this[key]){ne[key]=this[key]}}return ne};function EventDelegate(scene){this.scene=scene;this.watchMouseDrag=false}EventDelegate.prototype.init=function(){var el=this.scene.el;if(!el.addEventListener){el=document}el.addEventListener("mousedown",utils.delegate(this,"onmousedown"));el.addEventListener("mouseup",utils.delegate(this,"onmouseup"));el.addEventListener("mousemove",utils.delegate(this,"onmousemove"));el.addEventListener("touchstart",utils.delegate(this,"ontouchstart"));el.addEventListener("touchmove",utils.delegate(this,"ontouchmove"));el.addEventListener("touchend",utils.delegate(this,"ontouchend"));el.addEventListener("mouseout",utils.delegate(this,"onmouseout"));el.addEventListener("mousewheel",utils.delegate(this,"onmousewheel"));el.addEventListener("DOMMouseScroll",utils.delegate(this,"onmousewheel"));return this};EventDelegate.prototype.translatePoint=function(x,y){if(this.offsetX==null){var el=this.scene.el;if(el.getBoundingClientRect){var bbox=el.getBoundingClientRect();this.offsetX=bbox.left*(el.width/bbox.width);this.offsetY=bbox.top*(el.height/bbox.height)}else{this.offsetX=this.offsetY=0}}x-=this.offsetX;y-=this.offsetY;return{x:x,y:y}};EventDelegate.prototype.onmousedown=function(e){this.watchMouseDrag=true;var p=this.translatePoint(e.clientX,e.clientY);var event=new Event("mousedown",p.x,p.y);this.scene._trigger_mousedown(event);if(e.preventDefault){e.preventDefault()}};EventDelegate.prototype.onmouseup=function(e){this.watchMouseDrag=false;var p=this.translatePoint(e.clientX,e.clientY);var event=new Event("mouseup",p.x,p.y);this.scene._trigger_mouseup(event);if(e.preventDefault){e.preventDefault()}};EventDelegate.prototype.onmouseout=function(e){if(this.watchMouseDrag){this.onmouseup(e)}};EventDelegate.prototype.onmousemove=function(e){if(this.watchMouseDrag){var p=this.translatePoint(e.clientX,e.clientY);var event=new Event("mousemove",p.x,p.y);this.scene._trigger_mousemove(event)}if(e.preventDefault){e.preventDefault()}};EventDelegate.prototype.ontouchstart=function(e){if(e.touches.length===1){this.onmousedown({clientX:e.touches[0].pageX,clientY:e.touches[0].pageY})}var event=new Event("touchstart");var touches=[];for(var i=0;i<e.touches.length;i++){var touch=this.translatePoint(e.touches[i].pageX,e.touches[i].pageY);touches.push(touch)}event.touches=touches;this.scene.emit("touchstart",event);if(e.preventDefault){e.preventDefault()}};EventDelegate.prototype.ontouchmove=function(e){if(e.touches.length===1){this.onmousemove({clientX:e.touches[0].pageX,clientY:e.touches[0].pageY})}var event=new Event("touchmove");var touches=[];for(var i=0;i<e.touches.length;i++){var touch=this.translatePoint(e.touches[i].pageX,e.touches[i].pageY);touches.push(touch)}event.touches=touches;this.scene.emit("touchmove",event);if(e.preventDefault){e.preventDefault()}};EventDelegate.prototype.ontouchend=function(e){if(e.changedTouches.length===1){this.onmouseup({clientX:e.changedTouches[0].pageX,clientY:e.changedTouches[0].pageY})}var event=new Event("touchend");var touches=[];for(var i=0;i<e.touches.length;i++){var touch=this.translatePoint(e.touches[i].pageX,e.touches[i].pageY);touches.push(touch)}event.touches=touches;this.scene.emit("touchend",event);if(e.preventDefault){e.preventDefault()}};EventDelegate.prototype.onmousewheel=function(e){var p=this.translatePoint(e.clientX,e.clientY);var event=new Event("mousewheel",p.x,p.y);if(e.wheelDeltaY){event.wheelDeltaY=e.wheelDeltaY||0;event.wheelDeltaX=e.wheelDeltaX||0}else if(e.wheelDelta){event.wheelDeltaY=e.wheelDelta;event.wheelDeltaX=0}else{event.wheelDeltaY=-120*e.detail/3;event.wheelDeltaX=0}this.scene._trigger_mousewheel(event);if(e.preventDefault){e.preventDefault()}NotificationReceiver.emit("render")};module.exports.EventDelegate=EventDelegate;module.exports.Event=Event});require.register("ika/src/transform.js",function(exports,module){function Transform(){this.reset();this.histories=[];this.rotate3YScale=.5}Transform.prototype.reset=function(){this.m=[1,0,0,1,0,0]};Transform.prototype.save=function(){this.histories.push(this.m)};Transform.prototype.restore=function(){if(this.histories.length!==0){this.m=this.histories.pop()}};Transform.prototype.multiply=function(matrix){var m11=this.m[0]*matrix.m[0]+this.m[2]*matrix.m[1];var m12=this.m[1]*matrix.m[0]+this.m[3]*matrix.m[1];var m21=this.m[0]*matrix.m[2]+this.m[2]*matrix.m[3];var m22=this.m[1]*matrix.m[2]+this.m[3]*matrix.m[3];var dx=this.m[0]*matrix.m[4]+this.m[2]*matrix.m[5]+this.m[4];var dy=this.m[1]*matrix.m[4]+this.m[3]*matrix.m[5]+this.m[5];this.m[0]=m11;this.m[1]=m12;this.m[2]=m21;this.m[3]=m22;this.m[4]=dx;this.m[5]=dy};Transform.prototype.invert=function(){var d=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]);var m0=this.m[3]*d;var m1=-this.m[1]*d;var m2=-this.m[2]*d;var m3=this.m[0]*d;var m4=d*(this.m[2]*this.m[5]-this.m[3]*this.m[4]);var m5=d*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);this.m[0]=m0;this.m[1]=m1;this.m[2]=m2;this.m[3]=m3;this.m[4]=m4;this.m[5]=m5};Transform.prototype.scale=function(sx,sy){this.m[0]*=sx;this.m[1]*=sx;this.m[2]*=sy;this.m[3]*=sy};Transform.prototype.rotate=function(rad){var c=Math.cos(rad);var s=Math.sin(rad);var m11=this.m[0]*c+this.m[2]*s;var m12=this.m[1]*c+this.m[3]*s;var m21=this.m[0]*-s+this.m[2]*c;var m22=this.m[1]*-s+this.m[3]*c;this.m[0]=m11;this.m[1]=m12;this.m[2]=m21;this.m[3]=m22};Transform.prototype.rotateX=function(rad){rad=this._normalizeRad(rad);this.scale(1,Math.cos(rad))};Transform.prototype.rotateY=function(rad){rad=this._normalizeRad(rad);this.scale(Math.cos(rad),1)};Transform.prototype.rotate3=function(rad,radius){rad=this._normalizeRad(rad);var s=Math.sin(rad);var c=Math.cos(rad);var y=radius*s*this.rotate3YScale;var x=radius*c;var _rad=Math.asin(y/radius);this.m[0]=x/radius;this.m[1]=Math.tan(_rad)};Transform.prototype.translate=function(x,y){this.m[4]+=this.m[0]*x+this.m[2]*y;this.m[5]+=this.m[1]*x+this.m[3]*y};Transform.prototype.transformPoint=function(px,py){var x=px;var y=py;px=x*this.m[0]+y*this.m[2]+this.m[4];py=x*this.m[1]+y*this.m[3]+this.m[5];return{x:px,y:py}};Transform.prototype.invertPoint=function(px,py){var y=(py-this.m[5]+this.m[4]*this.m[1]/this.m[0]-px*this.m[1]/this.m[0])/(this.m[3]-this.m[2]*this.m[1]/this.m[0]);var x=(px-y*this.m[2]-this.m[4])/this.m[0];return{x:x,y:y}};Transform.prototype._normalizeRad=function(rad){while(rad>Math.PI*2){rad-=Math.PI*2}while(rad<0){rad+=Math.PI*2}return rad};module.exports=Transform});require.register("ika/src/model.js",function(exports,module){var Emitter=require("component~emitter@1.2.0");var ArrayMgr=require("akirakazu~arraymgr@master");function Model(){Emitter.call(this);this.changed=false}Model.prototype=new Emitter;Model.prototype.init=function(name){this.name=name||"untitled";this._values={};this._regexs={};return this};Model.prototype.bind=function(key,el){var self=this;el.on("change",function(val){self.set(key,val,this)});this.on("change:"+key,function(val,emitter){if(emitter!==el){el.setValue(val);NotificationReceiver.emit("render")}});return this};Model.prototype.watch=function(key,el,type,elKey,fn){this.on("change:"+key,function(val){if(fn){val=fn(val)}el[type](elKey,val);NotificationReceiver.emit("render")});return this};Model.prototype.get=function(key){return this._values[key]};Model.prototype.set=function(key,val,agent){if(!this._validate(key,val)){this.emit("error:"+key,val)}else{this._values[key]=val;this.emit("change:"+key,val,agent);this.emit("change",this._values)}return this};Model.prototype.getValue=function(){return this._values};Model.prototype.setValue=function(val){this._values=val;return thisl};Model.prototype.setValidator=function(key,regex){this._regexs[key]=regex};Model.prototype._validate=function(key,value){if(!this._regexs[key]||this._regexs[key].test(value)){return true}};Model.prototype.save=function(){localStorage.setItem(this.name,JSON.stringify(this._values))};Model.prototype.load=function(){this._values=JSON.parse(localStorage.getItem(this.name))};module.exports=Model});require.register("ika/src/easy_setup.js",function(exports,module){var Scene=require("ika/src/scene.js");var lastTime=0;var vendors=["ms","moz","webkit","o"];for(var x=0;x<vendors.length&&!self.requestAnimationFrame;++x){window.requestAnimationFrame=window[vendors[x]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[vendors[x]+"CancelAnimationFrame"]||window[vendors[x]+"CancelRequestAnimationFrame"]}if(window.requestAnimationFrame===undefined&&window["setTimeout"]!==undefined){window.requestAnimationFrame=function(callback){var currTime=Date.now(),timeToCall=Math.max(0,16-(currTime-lastTime));var id=window.setTimeout(function(){callback(currTime+timeToCall)},timeToCall);lastTime=currTime+timeToCall;return id}}if(window.cancelAnimationFrame===undefined&&window["clearTimeout"]!==undefined){window.cancelAnimationFrame=function(id){window.clearTimeout(id)}}function bindScene(scene){NotificationReceiver.intervalId=0;NotificationReceiver.endTime=0;NotificationReceiver.on("render",function(){scene.render()});setInterval(function(){if(scene._downPoint==null&&Date.now()>=NotificationReceiver.endTime){if(NotificationReceiver.intervalId!==0){clearInterval(NotificationReceiver.intervalId);NotificationReceiver.intervalId=0}}},5e3);function step(){scene.render();NotificationReceiver.intervalId=requestAnimationFrame(step)}NotificationReceiver.on("start-render",function(t){if(this.intervalId===0){this.intervalId=setInterval(function(){scene.render()},1e3/30)}if(!t){return}t+=500;var endTime=Date.now()+t;if(endTime>this.endTime){this.endTime=endTime}});NotificationReceiver.on("show-popover",function(item,baseitem){if(!item||!baseitem){return}var pos=scene.getChildPosition(baseitem);if(!pos){return}var bi=item.getBound();var bb=baseitem.getBound();if(pos.x+bi.width>scene.width){pos.x=pos.x+bb.width-bi.width}if(pos.y+bb.height+bi.height<=scene.height){pos.y+=bb.height}else{pos.y=pos.y-bi.height}scene.showPopover(item,pos.x,pos.y)});NotificationReceiver.on("hide-popover",function(){scene.hidePopover()});scene.on("mousedown",function(){if(NotificationReceiver.ika_input){NotificationReceiver.input.blur()}});NotificationReceiver.on("get-text",function(ika_input){if(!this.input){var input=document.createElement("input");input.setAttribute("type","text");input.style.margin="0px";input.style.padding="0px";input.style.position="fixed";input.style.display="none";this.input=input;document.body.appendChild(input);var self=this;input.onblur=function(e){if(self.ika_input){self.ika_input.setValue(this.value);self.ika_input.emit("change",this.value);scene.render();self.ika_input=null}this.style.display="none"};input.onkeydown=function(e){if(e.keyCode!==13){return}if(self.ika_input){self.ika_input.emit("enter",this.value,this)}}}this.ika_input=ika_input;this.input.setAttribute("type",ika_input.attr("type"));var pos=scene.getChildPosition(ika_input);this.input.style.left=pos.x+"px";this.input.style.top=pos.y+"px";var b=ika_input.getBound();this.input.style.padding=ika_input.css("padding")+"px";this.input.style.width=b.width-ika_input.css("padding")*2-ika_input.css("border-width")*2+"px";this.input.style.height=b.height-ika_input.css("padding")*2-ika_input.css("border-width")*2+"px";this.input.style.borderWidth=ika_input.css("border-width")+"px";this.input.style.borderColor=ika_input.css("border-color");this.input.style.fontSize=ika_input.css("font-size")+"px";this.input.style.fontFamily=ika_input.css("font-name");this.input.style.display="block";this.input.value=ika_input.getValue();this.input.focus()})}module.exports.bindScene=bindScene;module.exports.easySetup=function(canvas){document.body.style.overflow="hidden";var _canvas;if(canvas==null){var c=document.getElementById("canvas");if(c&&c.getContext){_canvas=document.getElementById("canvas")}else{_canvas=document.createElement("canvas");document.body.appendChild(_canvas)}}else{_canvas=canvas}var scene=new Scene(window.innerWidth,window.innerHeight,_canvas).init();bindScene(scene);window.addEventListener("resize",function(){scene.resize(window.innerWidth,window.innerHeight)});return scene}});require.register("ika/src/parse_xml.js",function(exports,module){var utils=require("ika/src/utils.js");var klasses=require("ika/src/klasses.js");var elementLists=["Textarea","Button","Switch","Label","Picture","Slider","Circle","Path","Input","Sprite","Combobox","Progress","Group","Scrollbase","Listbase","Swipe","Buttonset","Stack","Fan","Menu"];function isNumber(d){if(/-?^\d+$/g.test(d)){return true}}function capitaliseFirstLetter(str){return str.charAt(0).toUpperCase()+str.slice(1)}function walk(dom,parent){if(!dom.childNodes){return}if(dom.nodeName[0]==="#"){for(var i=0,len=dom.childNodes.length;i<len;i++){walk(dom.childNodes[i],parent)}}else{var klassName=capitaliseFirstLetter(dom.nodeName);if(elementLists.indexOf(klassName)===-1){throw"no element "+klassName+" found";return}var elem=(new klasses[klassName]).init();for(var i=0;i<dom.attributes.length;i++){var key=dom.attributes[i].nodeName;var value=dom.getAttribute(key);if(isNumber(value)){value=parseInt(value,10)}if(value==="true"){value=true}if(value==="false"){value=false}elem.attr(key,value)}parent.add(elem);if(dom.childNodes.length===1&&dom.childNodes[0].nodeName==="#text"){elem.attr("value",dom.childNodes[0].nodeValue)}else{for(var i=0,len=dom.childNodes.length;i<len;i++){walk(dom.childNodes[i],elem)}}}}module.exports.createElementsFromXML=function(xml,parent){walk(utils.parseXML(xml),parent)}});require.register("ika/src/element.js",function(exports,module){var Emitter=require("component~emitter@1.2.0");var ArrayMgr=require("akirakazu~arraymgr@master");var utils=require("ika/src/utils.js");var PICTURES=require("ika/src/public_pictures.js");var effects=require("ika/src/effects.js");var Ease=require("akirakazu~ika-animations@master").Ease;function Element(){Emitter.call(this);this.name="Element";this.visible=true;this.x=0;this.y=0;this.height=0;this.width=0;this.styles={"border-width":0,"box-shadow-x":0,"box-shadow-y":0,"box-shadow-blur":0,"box-shadow-color":"rgba(0, 0, 0, 0)","border-color":"rgba(0, 0, 0, 0)","background-color":"rgba(0, 0, 0, 0)","border-radius":0,color:"black","font-size":14,"font-name":"helvetica"};this._attrChangeWatchers={};this._cssChangeWatchers={}}Element.prototype=new Emitter;Element.prototype.init=function(){this.animations=new ArrayMgr;var self=this;this.watchCss("background-image",function(){self._background_image=null;self._background_image_ready=false});return this};Element.prototype.render=function(ctx){};Element.prototype.hitTest=function(x,y){var b=this.getBound();if(utils.isPointInRect(x,y,b.x,b.y,b.width,b.height)){return this}};Element.prototype.getBound=function(){if(this.visible){return{x:this.x,y:this.y,width:this.width,height:this.height}}else{return{x:this.x,y:this.y,width:0,height:0}}};Element.prototype.attr=function(key,val){if(typeof key=="object"&&val==null){for(var k in key){this.attr(k,key[k])}return this}if(key==null){return this}else if(val==null){return this[key]}else{this[key]=val;if(this._attrChangeWatchers[key]){this._attrChangeWatchers[key].iterate(function(fn){fn(val)})}return this}};Element.prototype.css=function(key,val){if(typeof key=="object"&&val==null){for(var k in key){this.css(k,key[k])}return this}if(key==null){return this}else if(val==null){return this.styles[key]}else{this.styles[key]=val;if(this._cssChangeWatchers[key]){this._cssChangeWatchers[key].iterate(function(fn){fn(val)})}return this}};Element.prototype.watchAttr=function(key,fn){if(!key||!fn){return}if(!this._attrChangeWatchers[key]){this._attrChangeWatchers[key]=new ArrayMgr}this._attrChangeWatchers[key].add(fn)};Element.prototype.watchCss=function(key,fn){if(!key||!fn){return}if(!this._cssChangeWatchers[key]){this._cssChangeWatchers[key]=new ArrayMgr}this._cssChangeWatchers[key].add(fn)};Element.prototype._updateAnimation=function(){this.animations.iterate(function(animation){if(animation&&animation.isAnimating){animation.step()}})};Element.prototype.animateTo=function(x,y,opts){if(x==null||y==null){return}opts=opts||{};var t=opts.t||300;var type=opts.type||"outExpo";var fn=opts.fn||function(){};var animateX=x!==this.x;var animateY=y!==this.y;var self=this;if(animateX){var eax=new Ease(this.x,x,t,type);this.animations.add(eax);eax.on("step",function(value){self.x=value});eax.on("end",function(){self.x=x;self.animations.rm(eax);fn()});eax.animate()}if(animateY){var eay=new Ease(this.y,y,t,type);this.animations.add(eay);eay.on("step",function(value){self.y=value});eay.on("end",function(){self.y=y;self.animations.rm(eay);if(!animateX){fn()}});eay.animate()}};Element.prototype.bind=function(methodName){var self=this;return function(){return self[methodName].apply(self,arguments)}};Element.prototype.clip=function(ctx,startFromZero){var bound=this.getBound();var x=startFromZero?0:bound.x;var y=startFromZero?0:bound.y;var width=bound.width;var height=bound.height;ctx.beginPath();ctx.moveTo(x,y);ctx.lineTo(x+width,y);ctx.lineTo(x+width,y+height);ctx.lineTo(x,y+height);ctx.closePath();ctx.clip()};Element.prototype._applyStyle=function(ctx,css){css=css||"background-color";var bc=this.css(css);var b=this.getBound();if(typeof bc==="object"){var type=bc.type||"linear";var colors=bc.colors||[];var startX,startY,endX,endY,startR,endR;startX=bc.startX||b.x;startY=bc.startY||b.y;endX=bc.endX||b.x;endY=bc.endY||b.y+b.height;var gradient=ctx.createLinearGradient(startX,startY,endX,endY);for(var i=0;i<colors.length;i++){gradient.addColorStop(colors[i][0],colors[i][1])}ctx.fillStyle=gradient}else{ctx.fillStyle=bc}ctx.shadowOffsetX=this.css("box-shadow-x");ctx.shadowOffsetY=this.css("box-shadow-y");ctx.shadowBlur=this.css("box-shadow-blur");ctx.shadowColor=this.css("box-shadow-color")};Element.prototype.applyBackgroundStyles=function(ctx){return this._applyStyle(ctx)};Element.prototype.renderBackgroundImage=function(ctx,startFromZero){if(!this._background_images){this._loadBackgroundImage();return}if(this._background_images_loaded_count<this._background_images.length){return}var b=this.getBound();var x=startFromZero?0:b.x;var y=startFromZero?0:b.y;if(this._background_images.length===1){ctx.drawImage(this._background_images[0],x,y,b.width,b.height)}else if(this._background_images.length===9){var top=this.css("background-image-top")||5;var bottom=this.css("background-image-bottom")||5;var left=this.css("background-image-left")||5;var right=this.css("background-image-right")||5;var bounds=[[0,0,left,top],[left,0,b.width-left-right,top],[b.width-right,0,right,top],[0,top,left,b.height-top-bottom],[left,top,b.width-left-right,b.height-top-bottom],[b.width-right,top,right,b.height-top-bottom],[0,b.height-bottom,left,bottom],[left,b.height-bottom,b.width-left-right,bottom],[b.width-right,b.height-bottom,right,bottom]];for(var i=0;i<bounds.length;i++){ctx.drawImage(this._background_images[i],bounds[i][0]+x,bounds[i][1]+y,bounds[i][2]+1,bounds[i][3]+1)}}};Element.prototype._loadBackgroundImage=function(){this._background_images=[];this._background_images_loaded_count=0;var self=this;var bi=this.css("background-image");if(typeof bi==="string"){this._loadBackgroundImageCell(bi)}else if(typeof bi==="object"){for(var i=0;i<bi.length;i++){this._loadBackgroundImageCell(bi[i])}}};Element.prototype._loadBackgroundImageCell=function(url){var self=this;if(PICTURES[url]){var img=PICTURES[url];this._background_images.push(img);if(!img.getAttribute("loaded")){img.addEventListener("load",function(){self._background_images_loaded_count+=1;NotificationReceiver.emit("render",self)})}else{self._background_images_loaded_count+=1}}else{var img=document.createElement("img");PICTURES[url]=img;this._background_images.push(img);img.onload=function(){this.setAttribute("loaded",true);self._background_images_loaded_count+=1;NotificationReceiver.emit("render",self)};img.src=url}};Element.prototype._renderSingleBackgroundImagePiece=function(ctx,img,x,y,width,height){ctx.drawImage(img,x,y,width,height)};Element.prototype.renderBackgroundBlur=function(ctx,startFromZero){var b=this.getBound();var x=startFromZero?0:b.x;var y=startFromZero?0:b.y;var imageData=ctx.getImageData(x,y,b.width,b.height);imageData.data=effects.mosaic(imageData.data,b.width,b.height,10);ctx.putImageData(imageData,x,y)};Element.prototype.renderBackground=function(ctx,startFromZero){ctx.save();var b=this.getBound();var x=startFromZero?0:b.x;var y=startFromZero?0:b.y;if(this.css("background-image")){this.renderBackgroundImage(ctx,startFromZero)}else{if(this.css("background-mosaic")){this.renderBackgroundBlur(ctx,startFromZero)}this.applyBackgroundStyles(ctx);if(this.css("border-radius")){this._drawRadiusPath(ctx,x,y,b);ctx.fill()}else{ctx.fillRect(x,y,b.width,b.height)}}ctx.restore()};Element.prototype._drawRadiusPath=function(ctx,x,y,b){var r=this.css("border-radius");if(r*2>b.height){r=b.height/2}if(r*2>b.width){r=b.width/2}ctx.beginPath();ctx.moveTo(x,y+r);ctx.arc(x+r,y+r,r,Math.PI,Math.PI*3/2);ctx.lineTo(x+b.width-r,y);ctx.arc(x+b.width-r,y+r,r,Math.PI*3/2,0);ctx.lineTo(x+b.width,y+b.height-r);ctx.arc(x+b.width-r,y+b.height-r,r,0,Math.PI/2);ctx.lineTo(x+r,y+b.height);ctx.arc(x+r,y+b.height-r,r,Math.PI/2,Math.PI);ctx.lineTo(x,y+r);ctx.closePath()};Element.prototype.applyBorderStyles=function(ctx){ctx.strokeStyle=this.css("border-color");ctx.lineWidth=this.css("border-width")};Element.prototype.renderBorder=function(ctx,startFromZero){var b=this.getBound();var x=startFromZero?0:b.x;var y=startFromZero?0:b.y;this.applyBorderStyles(ctx);if(this.css("border-radius")){this._drawRadiusPath(ctx,x,y,b);ctx.stroke()}else{ctx.strokeRect(x,y,b.width,b.height)}};Element.prototype.dispose=function(){this.removeAllListeners();this.animations.dispose();for(var k in this._attrChangeWatchers){this._attrChangeWatchers[k].dispose()}for(var j in this._cssChangeWatchers){this._cssChangeWatchers[j].dispose()}};module.exports=Element});require.register("ika/src/public_pictures.js",function(exports,module){module.exports={}});require.register("ika/src/elements/textarea.js",function(exports,module){var Element=require("ika/src/element.js");var utils=require("ika/src/utils.js");function Textarea(){Element.call(this);this.name="Textarea";this.value="";this.width=200;this.height=100;this.useCache=true;this.caches=[];this.lineNumber=0;this.css({"text-baseline":"top","text-align":"start","line-height":1.5,"font-weight":"normal","font-name":"helvetica",color:utils.colorOne});this.autoHeight=true}Textarea.prototype=new Element;Textarea.prototype.init=function(){Element.prototype.init.call(this);var self=this;this.watchAttr("value",function(val){self.caches=[]});return this};Textarea.prototype.render=function(ctx){ctx.save();this.renderBackground(ctx);this.clip(ctx);ctx.font=this.css("font-weight")+" "+this.css("font-size")+"px "+this.css("font-name");ctx.fillStyle=this.css("color");ctx.textAlign=this.css("text-align");ctx.textBaseline=this.css("text-baseline");var rerender=false;if(this.useCache&&this.caches.length!==0){this._drawWithCache(ctx)}else{var lines=this.value.split("\n");for(var i=0;i<lines.length;i++){if(this._drawLine(ctx,lines[i])){rerender=true;break}}}this.lineNumber=0;ctx.restore();if(rerender){this.caches=[];this.emit("size-changed",{height:this.height})}return rerender};Textarea.prototype._getX=function(){var x=0;var align=this.css("text-align");if(align==="center"){x=this.x+this.width/2}else if(align==="right"){x=this.x+this.width}else{x=this.x}return x};Textarea.prototype._drawWithCache=function(ctx){for(var i=0,len=this.caches.length;i<len;i++){this._drawText(ctx,this.caches[i],this._getX(),this.y+i*this.css("line-height")*this.css("font-size"))}};Textarea.prototype._drawLine=function(ctx,line){var rerender=false;while(ctx.measureText(line).width>this.width){var x=Math.floor(this.width*line.length/ctx.measureText(line).width);while(ctx.measureText(line.substring(0,x)).width<this.width){x+=1}while(ctx.measureText(line.substring(0,x)).width>=this.width){x-=1}while(this._isCharInsideWord(line,x)){x-=1}var _line=line.substring(0,x);this.caches.push(_line);this._drawText(ctx,_line,this._getX(),this.y+this.lineNumber*this.css("line-height")*this.css("font-size"));
line=line.substring(x);if(this._checkHeight()){rerender=true}this.lineNumber+=1}if(line!==""){this.caches.push(line);this._drawText(ctx,line,this._getX(),this.y+this.lineNumber*this.css("line-height")*this.css("font-size"));if(this._checkHeight()){rerender=true}this.lineNumber+=1}return rerender};Textarea.prototype._isCharInsideWord=function(text,index){var regex=/[a-z]/;return regex.test(text[index-1])&&regex.test(text[index])};Textarea.prototype._checkHeight=function(){if(!this.autoHeight){return}if((this.lineNumber+1)*this.css("line-height")*this.css("font-size")>this.height){this.height=(this.lineNumber+1)*this.css("line-height")*this.css("font-size");return true}};Textarea.prototype._drawText=function(ctx,text,x,y){ctx.fillText(text,x,y)};module.exports=Textarea});require.register("ika/src/elements/scroller.js",function(exports,module){var Element=require("ika/src/element.js");var utils=require("ika/src/utils.js");var Ease=require("akirakazu~ika-animations@master").Ease;function Scroller(){Element.call(this);this.type="vertical";this.width=4;this.css("opacity",0)}Scroller.prototype=new Element;Scroller.prototype.init=function(){Element.prototype.init.call(this);return this};Scroller.prototype.getBound=function(){if(this.type==="vertical"){return{x:this.x,y:this.y,width:this.width,height:this.length}}else{return{x:this.x,y:this.y,width:this.length,height:this.width}}};Scroller.prototype.hitTest=function(x,y){var b=this.getBound();if(utils.isPointInRect(x,y,b.x,b.y,b.width,b.height)){return this}};Scroller.prototype.render=function(ctx){if(this.css("opacity")===0){return}ctx.save();ctx.fillStyle="rgba(50, 50, 50, "+this.css("opacity")+")";ctx.shadowColor="rgba(255,255,255,0.3)";ctx.shadowBlur=10;var b=this.getBound();ctx.beginPath();ctx.rect(b.x,b.y,b.width,b.height);ctx.closePath();ctx.fill();ctx.restore()};Scroller.prototype.hide=function(){if(this.isHiding){return}this.isHiding=true;var self=this;self.hideTimeout=setTimeout(function(){self.hideTimeout=null;var sa=new Ease(self.css("opacity"),0,200);self.animations.add(sa);sa.on("step",function(value){self.css("opacity",value)});sa.on("end",function(){self.css("opacity",0);self.animations.rm(sa);self.isHiding=false});sa.animate()},200)};Scroller.prototype.show=function(){if(!this.isHiding){this.css("opacity",.8);return}if(this.hideTimeout){clearTimeout(this.hideTimeout);this.hideTimeout=null}this.animations.iterate(function(a){a.abort()});this.animations.empty();this.css("opacity",.8);this.isHiding=false};module.exports=Scroller});require.register("ika/src/elements/button.js",function(exports,module){var utils=require("ika/src/utils.js");var Element=require("ika/src/element.js");function Button(value){Element.call(this);this.name="Button";this.isInput=true;this.value=value||"";this.width=80;this.height=30;this.autoWidth=true;this.disabled=false;this.active=false;this.isMouseTarget=false;this.dummy=new Element;this.backgroundColor={type:"linear",colors:[[0,"white"],[1,"rgb(235,235,235)"]]};this.activeBackgroundColor={type:"linear",colors:[[0,"rgb(235,235,235)"],[1,"white"]]};this.borderColor=this.activeBorderColor="rgb(100,100,100)";this.css({color:utils.colorOne,"active-color":utils.colorOne,"disabled-color":"#999","border-width":1,"text-align":"center",padding:10,"text-baseline":"middle","text-shadow-x":0,"text-shadow-y":1,"text-shadow-color":"white","text-shadow-blur":0})}Button.prototype=new Element;Button.prototype.init=function(flag){Element.prototype.init.call(this);if(!flag){this.on("mousedown",function(){this.isMouseTarget=true;NotificationReceiver.emit("render",this)});this.on("mousedragend",function(){this.isMouseTarget=false;NotificationReceiver.emit("render",this)});this.on("mouseup",function(){this.isMouseTarget=false;NotificationReceiver.emit("render",this)})}return this};Button.prototype.render=function(ctx){var rerender=false;ctx.save();if(this.active||this.isMouseTarget){this.css("background-color",this.activeBackgroundColor)}else{this.css("background-color",this.backgroundColor)}this.renderBackground(ctx);ctx.font=this.css("font-size")+"px "+this.css("font-name");if(this.autoWidth&&ctx.measureText(this.value).width+this.css("padding")*2>this.width){this.width=ctx.measureText(this.value).width+this.css("padding")*2;this.emit("size-changed",{width:this.width});rerender=true}if(this.disabled){ctx.fillStyle=this.css("disabled-color")}else if(this.active||this.isMouseTarget){ctx.fillStyle=this.css("active-color")}else{ctx.fillStyle=this.css("color")}var text_align=this.css("text-align");ctx.textAlign=text_align;ctx.textBaseline=this.css("text-baseline");var x=0,y=0;if(text_align==="center"){x=this.x+this.width/2;y=this.y+this.height/2}else if(text_align==="left"){x=this.x;y=this.y+this.height/2}else if(text_align==="right"){x=this.x+this.width;y=this.y+this.height/2}ctx.shadowOffsetX=this.css("text-shadow-x");ctx.shadowOffsetY=this.css("text-shadow-y");ctx.shadowColor=this.css("text-shadow-color");ctx.shadowBlur=this.css("text-shadow-blur");ctx.fillText(this.value,x,y);if(this.active||this.isMouseTarget){this.css("border-color",this.activeBorderColor)}else{this.css("border-color",this.borderColor)}this.renderBorder(ctx);ctx.restore();return rerender};Button.prototype.hitTest=function(x,y){if(utils.isPointInRect(x,y,this.x,this.y,this.width,this.height)){if(this.disabled){return this.dummy}else{return this}}};Button.prototype.disable=function(){if(!this.disabled){this.disabled=true;NotificationReceiver.emit("render",this)}};Button.prototype.enable=function(){if(this.disabled){this.disabled=false;NotificationReceiver.emit("render",this)}};module.exports=Button});require.register("ika/src/elements/switch.js",function(exports,module){var Element=require("ika/src/element.js");var utils=require("ika/src/utils.js");var Ease=require("akirakazu~ika-animations@master").Ease;function Switch(){Element.call(this);this.name="Switch";this.isInput=true;this.height=30;this.width=80;this.switchButtonWidth=30;this.switchButtonOffset=0;this.isAnimating=false;this.status="off"}Switch.prototype=new Element;Switch.prototype.init=function(){Element.prototype.init.call(this);this.css({"background-color":{type:"linear",colors:[[0,"black"],[.9,"rgb(80,80,80)"],[1,"rgb(100,100,100)"]]},color:{type:"linear",colors:[[0,"white"],[1,"rgb(235,235,235)"]]},"border-width":1,"border-color":utils.colorOne,"front-color":{type:"linear",colors:[[0,"rgb(235,235,235)"],[1,"white"]]}});this.on("click",this.bind("onclick"));this.on("mousedrag",this.bind("onmousedrag"));this.on("mousedragend",this.bind("onmousedragend"));return this};Switch.prototype.render=function(ctx){ctx.save();this.renderBackground(ctx);this._applyStyle(ctx,"front-color");ctx.fillRect(this.x+this.switchButtonOffset+this.switchButtonWidth,this.y,this.width-this.switchButtonWidth-this.switchButtonOffset,this.height);this._applyStyle(ctx,"color");ctx.fillRect(this.x+this.switchButtonOffset,this.y,this.switchButtonWidth,this.height);this.renderBorder(ctx);ctx.strokeRect(this.x+this.switchButtonOffset,this.y,this.switchButtonWidth,this.height);ctx.restore()};Switch.prototype.onclick=function(event){if(this.isAnimating){return}var to;if(this.status==="off"){this.status="on";to=this.width-this.switchButtonWidth}else{this.status="off";to=0}this.emit("change",this.status);var ea=new Ease(this.switchButtonOffset,to,200);this.isAnimating=true;this.animations.add(ea);var self=this;ea.on("step",function(value){self.switchButtonOffset=value});ea.on("end",function(){self.switchButtonOffset=to;self.animations.rm(ea);self.isAnimating=false});ea.animate()};Switch.prototype.click=Switch.prototype.onclick;Switch.prototype.onmousedrag=function(event){if(!this._ondragging){this._ondragging=true;this._originalOffset=this.switchButtonOffset;this._startDraggingX=event.x;this._startDraggingY=event.y}else{var deltaX=event.x-this._startDraggingX;var newOffset=this._originalOffset+deltaX;if(newOffset>this.width-this.switchButtonWidth){newOffset=this.width-this.switchButtonWidth}else if(newOffset<0){newOffset=0}this.switchButtonOffset=newOffset;NotificationReceiver.emit("render",this)}};Switch.prototype.onmousedragend=function(event){var to;if(this.switchButtonOffset>=(this.width-this.switchButtonWidth)/2){to=this.width-this.switchButtonWidth;if(this.status==="off"){this.status="on";this.emit("change",this.status)}}else{to=0;if(this.status==="on"){this.status="off";this.emit("change",this.status)}}var self=this;var ea=new Ease(this.switchButtonOffset,to);ea.on("step",function(value){self.switchButtonOffset=value});ea.on("end",function(){self.switchButtonOffset=to;self.animations.rm(ea);self._ondragging=false;self._originalOffset=null;self._startDraggingPoint=null});this.animations.add(ea);ea.animate()};Switch.prototype.getValue=function(){return this.status};Switch.prototype.setValue=function(value){this.status=value;this.switchButtonOffset=this.status==="on"?this.width-this.switchButtonWidth:0};Switch.prototype.reset=function(){this.status="off";this.switchButtonOffset=0;NotificationReceiver.emit("render")};module.exports=Switch});require.register("ika/src/elements/label.js",function(exports,module){var Element=require("ika/src/element.js");var utils=require("ika/src/utils.js");function Label(){Element.call(this);this.name="Label";this.value="";this.width=100;this.height=30;this.autoWidth=false;this.css({padding:5,"font-name":"helvetica","font-weight":"normal","text-align":"left","text-baseline":"middle",color:utils.colorOne,"background-color":utils.colorTwo,"text-shadow-x":0,"text-shadow-y":0,"text-shadow-color":"rgba(0, 0, 0, 0)","text-shadow-blur":0})}Label.prototype=new Element;Label.prototype.render=function(ctx){var rerender=false;ctx.save();ctx.font=this.css("font-weight")+" "+this.css("font-size")+"px "+this.css("font-name");if(this.autoWidth&&ctx.measureText(this.value).width+this.css("padding")*2>this.width){this.width=ctx.measureText(this.value).width+this.css("padding")*2;this.emit("size-changed",{width:this.width});rerender=true}this.renderBackground(ctx);this.clip(ctx);ctx.fillStyle=this.css("color");var textAlign=this.css("text-align");ctx.textAlign=textAlign;ctx.textBaseline=this.css("text-baseline");ctx.shadowOffsetX=this.css("text-shadow-x");ctx.shadowOffsetY=this.css("text-shadow-y");ctx.shadowColor=this.css("text-shadow-color");ctx.shadowBlur=this.css("text-shadow-blur");var x,y;y=this.y+this.height/2;if(textAlign==="left"){x=this.css("padding")+this.x}else if(textAlign==="center"){x=this.x+this.width/2}else if(textAlign==="right"){x=this.x+this.width-this.css("padding")}ctx.fillText(this.value,x,y);ctx.restore();return rerender};module.exports=Label});require.register("ika/src/elements/picture.js",function(exports,module){var Element=require("ika/src/element.js");var PICTURES=require("ika/src/public_pictures.js");function Picture(){Element.call(this);this.name="Picture";this.imgHeight=0;this.imgWidth=0;this.src="";this.width=400;this.height=300;this.ready=false;this.type="fitBoth";this.types=["original","fitOne","fitWidth","fitHeight","fitBoth","fitBottom","fitTop","fitRight","fitLeft","autoWidth","autoHeight"];this.caches=null}Picture.prototype=new Element;Picture.prototype.init=function(){Element.prototype.init.call(this);var self=this;this.watchAttr("width",function(){self.caches=null});this.watchAttr("height",function(){self.caches=null});this.watchAttr("src",function(src){self.ready=false;if(PICTURES[src]){self.img=PICTURES[src];if(self.img.getAttribute("loaded")){self.imgHeight=self.img.height;self.imgWidth=self.img.width;self.ready=true;self.emit("load")}else{self.img.addEventListener("load",function(){self.imgHeight=this.height;self.imgWidth=this.width;self.ready=true;self.emit("load");NotificationReceiver.emit("render",self)})}}else{var img=document.createElement("img");img.src=src;PICTURES[src]=img;img.addEventListener("load",function(){self.imgHeight=this.height;self.imgWidth=this.width;this.setAttribute("loaded",true);self.ready=true;self.emit("load");NotificationReceiver.emit("render",self)});self.img=img}});return this};Picture.prototype.render=function(ctx){ctx.save();this.renderBackground(ctx);this.clip(ctx);if(!this.ready){ctx.textAlign="center";ctx.fillStyle="#eaeaea";ctx.fillText("loading",this.x+this.width/2,this.y+this.height/2)}else{ctx.translate(this.x,this.y);if(this.caches){var c=this.caches;this._drawImage(ctx,c.x,c.y,c.width,c.height)}else{var key="_render_"+this.type;if(this[key]){this[key](ctx)}}this.renderBorder(ctx)}ctx.restore()};Picture.prototype._render_original=function(ctx){var width=this.imgWidth;var height=this.imgHeight;var x=(this.getBound().width-width)/2;var y=(this.getBound().height-height)/2;this.caches={x:x,y:y,width:width,height:height};this._drawImage(ctx,x,y,width,height)};Picture.prototype._render_fitOne=function(ctx){var width=this.imgWidth;var height=this.imgHeight;var tan=width/height;var bound=this.getBound();var _width=bound.height*tan;var _height;if(_width>=bound.width){_width=bound.width;_height=bound.width/tan}else{_height=bound.height}var x=(bound.width-_width)/2;var y=(bound.height-_height)/2;this.caches={x:x,y:y,width:_width,height:_height};this._drawImage(ctx,x,y,_width,_height)};Picture.prototype._render_fitWidth=function(ctx){var width=this.imgWidth;var height=this.imgHeight;var tan=width/height;var bound=this.getBound();var _width=bound.width;var _height=_width/tan;var x=0;var y=(bound.height-_height)/2;this.caches={x:x,y:y,width:_width,height:_height};this._drawImage(ctx,x,y,_width,_height)};Picture.prototype._render_fitHeight=function(ctx){var width=this.imgWidth;var height=this.imgHeight;var tan=width/height;var bound=this.getBound();var _height=bound.height;var _width=_height*tan;var x=(bound.width-_width)/2;var y=0;this.caches={x:x,y:y,width:_width,height:_height};this._drawImage(ctx,x,y,_width,_height)};Picture.prototype._getRealBound=function(){var width=this.imgWidth;var height=this.imgHeight;var tan=width/height;var bound=this.getBound();var _width=bound.height*tan;var _height;if(_width>=bound.width){_height=bound.height}else{_width=bound.width;_height=bound.width/tan}return{width:_width,height:_height}};Picture.prototype._render_fitBoth=function(ctx){var bound=this.getBound();var rb=this._getRealBound();var x=(bound.width-rb.width)/2;var y=(bound.height-rb.height)/2;this.caches={x:x,y:y,width:rb.width,height:rb.height};this._drawImage(ctx,x,y,rb.width,rb.height)};Picture.prototype._render_fitBottom=function(ctx){var bound=this.getBound();var rb=this._getRealBound();var x=(bound.width-rb.width)/2;var y=bound.height-rb.height;this.caches={x:x,y:y,width:rb.width,height:rb.height};this._drawImage(ctx,x,y,rb.width,rb.height)};Picture.prototype._render_fitTop=function(ctx){var bound=this.getBound();var rb=this._getRealBound();var x=(bound.width-rb.width)/2;var y=0;this.caches={x:x,y:y,width:rb.width,height:rb.height};this._drawImage(ctx,x,y,rb.width,rb.height)};Picture.prototype._render_fitRight=function(ctx){var bound=this.getBound();var rb=this._getRealBound();var x=bound.width-rb.width;var y=(bound.height-rb.height)/2;this.caches={x:x,y:y,width:rb.width,height:rb.height};this._drawImage(ctx,x,y,rb.width,rb.height)};Picture.prototype._render_fitLeft=function(ctx){var bound=this.getBound();var rb=this._getRealBound();var x=0;var y=(bound.height-rb.height)/2;this.caches={x:x,y:y,width:rb.width,height:rb.height};this._drawImage(ctx,x,y,rb.width,rb.height)};Picture.prototype._render_autoWidth=function(ctx){var bound=this.getBound();var iw=this.imgWidth;var ih=this.imgHeight;var w=iw*bound.height/ih;if(this.width!==w){this.width=w;this.emit("size-changed",{width:this.width,height:this.height})}this.caches={x:0,y:0,width:this.width,height:this.height};this._drawImage(ctx,0,0,this.width,this.height)};Picture.prototype._render_autoHeight=function(ctx){var bound=this.getBound();var iw=this.imgWidth;var ih=this.imgHeight;var h=ih*bound.width/iw;if(this.height!==h){this.height=h;this.emit("size-changed",{width:this.width,height:this.height})}this.caches={x:0,y:0,width:this.width,height:this.height};this._drawImage(ctx,0,0,this.width,this.height)};Picture.prototype._drawImage=function(ctx,x,y,width,height){ctx.drawImage(this.img,x,y,width,height)};module.exports=Picture});require.register("ika/src/elements/slider.js",function(exports,module){var Element=require("ika/src/element.js");var utils=require("ika/src/utils.js");var Ease=require("akirakazu~ika-animations@master").Ease;function Slider(){Element.call(this);this.name="Slider";this.isInput=true;this.offset=0;this.value=0;this.min=0;this.max=1;this.active=false;this.type="horizontal";this.length=150;this.secondLength=24;this.isSliding=false}Slider.prototype=new Element;Slider.prototype.init=function(){Element.prototype.init.call(this);this.css({"front-color":utils.colorTwo,"stroke-color":utils.colorOne});this.on("mousedown",this.bind("onmousedown"));this.on("mousedrag",this.bind("onmousedrag"));this.on("mousedragend",this.bind("onmousedragend"));this.on("mouseup",this.bind("onmouseup"));return this};Slider.prototype.onmousedown=function(event){this.active=true;if(this.type==="horizontal"){this.offset=event.x-this.x-this.secondLength/2}else{this.offset=event.y-this.y-this.secondLength/2}this._finalizeOffset();this.dragStartX=event.x;this.dragStartY=event.y;this.dragStartOffset=this.offset};Slider.prototype._finalizeOffset=function(){if(this.offset>this.length-this.secondLength){this.offset=this.length-this.secondLength}else if(this.offset<0){this.offset=0}this.emit("change",Math.floor(this.min+(this.max-this.min)*(this.offset/(this.length-this.secondLength))));NotificationReceiver.emit("render",this)};Slider.prototype.onmousedrag=function(event){if(this.type==="horizontal"){this.offset=this.dragStartOffset+event.x-this.dragStartX}else{this.offset=this.dragStartOffset+event.y-this.dragStartY}this._finalizeOffset()};Slider.prototype.onmousedragend=function(event){this.active=false;this.dragStartX=0;this.dragStartY=0;this.dragStartOffset=0};Slider.prototype.onmouseup=Slider.prototype.onmousedragend;Slider.prototype.getBound=function(){if(this.type==="horizontal"){return{x:this.x,y:this.y,width:this.length,height:this.secondLength}}else{return{x:this.x,y:this.y,width:this.secondLength,height:this.length}}};Slider.prototype.slideTo=function(offset){if(this.isSliding){return}if(offset<0||offset>this.length-this.secondLength){return}this.isSliding=true;var ea=new Ease(this.offset,offset);this.animations.add(ea);var self=this;ea.on("step",function(value){self.offset=value});ea.on("end",function(){self.offset=offset;self._finalizeOffset();self.animations.rm(ea);self.isSliding=false});ea.animate()};Slider.prototype.render=function(ctx){ctx.save();var bound=this.getBound();this._applyStyle(ctx,"front-color");ctx.strokeStyle=this.css("stroke-color");ctx.lineWidth=1;if(this.type==="horizontal"){ctx.fillRect(bound.x,bound.y+(this.secondLength-10)/2,bound.width,10);ctx.strokeRect(bound.x,bound.y+(this.secondLength-10)/2,bound.width,10);ctx.fillRect(bound.x+this.offset,bound.y,this.secondLength,this.secondLength);ctx.strokeRect(bound.x+this.offset,bound.y,this.secondLength,this.secondLength)}else{ctx.fillRect(bound.x+(this.secondLength-10)/2,bound.y,10,bound.height);ctx.strokeRect(bound.x+(this.secondLength-10)/2,bound.y,10,bound.height);ctx.fillRect(bound.x,bound.y+this.offset,this.secondLength,this.secondLength);ctx.strokeRect(bound.x,bound.y+this.offset,this.secondLength,this.secondLength)}ctx.restore()};Slider.prototype.getValue=function(){return this.value};Slider.prototype.setValue=function(value){this.value=value;this.offset=(value-this.min)*(this.length-this.secondLength)/(this.max-this.min)};Slider.prototype.reset=function(){this.value=0;this.offset=0;NotificationReceiver.emit("render")};module.exports=Slider});require.register("ika/src/elements/circle.js",function(exports,module){var Element=require("ika/src/element.js");var utils=require("ika/src/utils.js");function Circle(){Element.call(this);this.name="Circle";this.radius=10}Circle.prototype=new Element;Circle.prototype.init=function(){Element.prototype.init.call(this);this.css("background-color",utils.colorOne);return this};Circle.prototype.render=function(ctx){ctx.save();ctx.beginPath();ctx.arc(this.x,this.y,this.radius,0,Math.PI*2);ctx.closePath();this.applyBackgroundStyles(ctx);ctx.fill();this.applyBorderStyles(ctx);ctx.stroke();ctx.restore()};Circle.prototype.hitTest=function(x,y){if(Math.pow(this.x-x,2)+Math.pow(this.y-y,2)<=this.radius*this.radius){return this}};Circle.prototype.getBound=function(){return{x:this.x-this.radius,y:this.y-this.radius,width:this.radius*2,height:this.radius*2}};module.exports=Circle});require.register("ika/src/elements/path.js",function(exports,module){var Element=require("ika/src/element.js");var ArrayMgr=require("akirakazu~arraymgr@master");function Path(){Element.call(this);this.selected=false}Path.prototype=new Element;Path.prototype.init=function(){Element.prototype.init.call(this);this.segments=new ArrayMgr;this.css("background-color","#eaeaea");return this};Path.prototype.add=function(){this.segments.add(Array.prototype.slice.call(arguments,0));return this};Path.prototype.rm=function(index){this.segments.rmByIndex(index);return this};Path.prototype.getBound=function(){var xmax=xmin=ymax=ymin=0;this.segments.iterate(function(s){if(s[0]>xmax){xmax=s[0]}if(s[0]<xmin){xmin=s[0]}if(s[1]>ymax){ymax=s[1]}if(s[1]<ymin){ymin=s[1]}});return{x:this.x,y:this.y,width:xmax-xmin,height:ymax-ymin}};Path.prototype.render=function(ctx){ctx.save();ctx.translate(this.x,this.y);this._drawPath(ctx);this.applyBackgroundStyles(ctx);ctx.fill();this.applyBorderStyles(ctx);ctx.stroke();if(this.selected){this._renderSegments(ctx)}ctx.restore()};Path.prototype._renderSegments=function(ctx){ctx.save();ctx.fillStyle="rgb(0,157,236)";ctx.strokeStyle="rgb(0,157,236)";ctx.lineWidth=1;var self=this;this.segments.iterate(function(s,i){if(s[2]!=null){self._renderSegment(ctx,s[4],s[5])}else{self._renderSegment(ctx,s[0],s[1])}});this._drawPath(ctx);ctx.stroke();ctx.restore()};Path.prototype._renderSegment=function(ctx,x,y){ctx.fillRect(x-2,y-2,4,4)};Path.prototype._drawPath=function(ctx){ctx.beginPath();var self=this;this.segments.iterate(function(s,i){if(i===0){ctx.moveTo(s[0],s[1])}else{if(s[4]!=null){ctx.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5])}else if(s[2]!=null){ctx.quadraticCurveTo(s[0],s[1],s[2],s[3])}else{ctx.lineTo(s[0],s[1])}}});ctx.closePath()};Path.prototype.hitTest=function(x,y,ctx){this._drawPath(ctx);x-=this.x;y-=this.y;if(ctx.isPointInPath(x,y)){return this}};module.exports=Path});require.register("ika/src/elements/input.js",function(exports,module){var Element=require("ika/src/element.js");var utils=require("ika/src/utils.js");function Input(){Element.call(this);this.name="Input";this.isInput=true;this.width=150;this.height=30;this.type="text";this.value="";this.placeholder="type in some text";this.instruction="type in some text"}Input.prototype=new Element;Input.prototype.init=function(){Element.prototype.init.call(this);this.css({color:utils.colorOne,"text-baseline":"top","border-width":1,"background-color":utils.colorTwo,"border-color":utils.colorOne,padding:6});this.on("click",this.bind("onclick"));return this};Input.prototype.render=function(ctx,timestamp){ctx.save();this.renderBackground(ctx);ctx.save();this.clip(ctx);ctx.font=this.css("font-size")+"px "+this.css("font-name");ctx.fillStyle=this.css("color");ctx.textAlign=this.css("text-align");ctx.textBaseline="middle";ctx.translate(this.x,this.y);var value=this.value;if(this.type==="password"){var len=value.length;value="";while(len--){value+="*"}}if(value===""&&this.type==="text"){value=this.placeholder}var width=ctx.measureText(value).width;if(width>this.width-this.css("padding")*2){var offset=width-this.width+this.css("padding")*2;ctx.fillText(value,this.css("padding")-offset,this.height/2)}else{ctx.fillText(value,this.css("padding"),this.height/2)}ctx.restore();this.renderBorder(ctx);ctx.restore()};Input.prototype.onclick=function(e){if(window.ejecta&&window.ejecta.getText){var self=this;ejecta.getText(this.instruction,"",function(value){if(value!=null&&value!==""){self.value=value;self.emit("change",value)}NotificationReceiver.emit("render")})}else{NotificationReceiver.emit("get-text",this)}};Input.prototype.getValue=function(){return this.value};Input.prototype.setValue=function(value){this.value=value};Input.prototype.reset=function(){this.value="";NotificationReceiver.emit("render")};module.exports=Input});require.register("ika/src/elements/sprite.js",function(exports,module){var Element=require("ika/src/element.js");var ArrayMgr=require("akirakazu~arraymgr@master");function Sprite(){Element.call(this);this.name="Sprite";this.width=400;this.height=300;this.ready=false;this.index=-1}Sprite.prototype=new Element;Sprite.prototype.init=function(){Element.prototype.init.call(this);this.slices=new ArrayMgr;this.img=document.createElement("img");var self=this;this.img.onload=function(){self.ready=true;NotificationReceiver.emit("render",this)};this.watchAttr("src",function(src){self.ready=false;self.img.src=src});this.watchAttr("index",function(){NotificationReceiver.emit("render",this)});return this};Sprite.prototype.addSlice=function(){var slice=Array.prototype.slice.call(arguments,0);this.slices.add(slice)};Sprite.prototype.render=function(ctx){if(!this.ready||this.slices.length()===0){return}var slice=this.slices.get(this.index);if(!slice){return}ctx.save();this.renderBackground(ctx);this.clip(ctx);ctx.drawImage(this.img,slice[0],slice[1],slice[2],slice[3],this.x,this.y,this.width,this.height);this.renderBorder(ctx);ctx.restore()};module.exports=Sprite});require.register("ika/src/elements/combobox.js",function(exports,module){var Input=require("ika/src/elements/input.js");var utils=require("ika/src/utils.js");var ArrayMgr=require("akirakazu~arraymgr@master");var Menu=require("ika/src/groups/menu.js");function Combobox(){Input.call(this);this.name="Combobox"}Combobox.prototype=new Input;Combobox.prototype.init=function(){Input.prototype.init.call(this,this);this.editable=true;this.css("button-color",utils.colorOne);this.options=new ArrayMgr;this.menu=(new Menu).init(this.width);this.createMenu();var self=this;this.watchAttr("options",function(options){options=options.split(",");self.options=new ArrayMgr(options);self.createMenu()});this.on("mousedown",this.bind("onmousedown"));return this};Combobox.prototype.addOption=function(option){this.options.add(option);this.createMenu();return this};Combobox.prototype.rmOption=function(option){this.options.rm(option);this.createMenu();return this};Combobox.prototype.createMenu=function(){this.menu.empty();var self=this;this.options.iterate(function(option){self.menu.add(option,function(){self.value=this.value;self.emit("change",self.value)})})};Combobox.prototype.render=function(ctx,timestamp){ctx.save();this.renderBackground(ctx);ctx.save();this.clip(ctx);ctx.font=this.css("font-size")+"px "+this.css("font-name");ctx.fillStyle=this.css("color");ctx.textAlign=this.css("text-align");ctx.textBaseline="middle";ctx.translate(this.x,this.y);var value=this.value;if(this.type==="password"){var len=value.length;value="";while(len--){value+="*"}}var width=ctx.measureText(value).width;if(width>this.width-this.height-this.css("padding")*2){var offset=width-this.width+this.height+this.css("padding")*2;ctx.fillText(value,this.css("padding")-offset,this.height/2)}else{ctx.fillText(value,this.css("padding"),this.height/2)}ctx.fillStyle=this.css("button-color");ctx.fillRect(this.width-this.height,0,this.height,this.height);ctx.restore();this.renderBorder(ctx);ctx.restore()};Combobox.prototype.onclick=function(e){var b=this.getBound();if(!utils.isPointInRect(e.x,e.y,b.x+b.width-b.height,b.y,b.height,b.height)&&this.editable){Input.prototype.onclick.call(this,arguments)}};Combobox.prototype.onmousedown=function(e){var b=this.getBound();if(!this.editable||utils.isPointInRect(e.x,e.y,b.x+b.width-b.height,b.y,b.height,b.height)){NotificationReceiver.emit("show-popover",this.menu,this)}};module.exports=Combobox});require.register("ika/src/elements/progress.js",function(exports,module){var Element=require("ika/src/element.js");var utils=require("ika/src/utils.js");function Progress(){Element.call(this);this.name="Progress";this.width=150;this.height=30;this.rate=0}Progress.prototype=new Element;Progress.prototype.init=function(){Element.prototype.init.call(this);this.css({"border-color":utils.colorOne,"background-color":{type:"linear",colors:[[0,"black"],[.9,"rgb(80,80,80)"],[1,"rgb(100,100,100)"]]},color:{type:"linear",colors:[[0,"white"],[1,"rgb(235,235,235)"]]}});return this};Progress.prototype.render=function(ctx){ctx.save();this.renderBackground(ctx);ctx.save();this._applyStyle(ctx,"color");ctx.fillRect(this.x,this.y,this.width*this.rate,this.height);this.renderBorder(ctx);ctx.restore()};Progress.prototype.update=function(rate){if(rate>1){rate=1}else if(rate<0){rate=0}this.rate=rate;NotificationReceiver.emit("render")};Progress.prototype.step=function(delta){delta=delta||.05;this.rate+=delta;if(this.rate>1){this.rate=1}NotificationReceiver.emit("render")};module.exports=Progress});require.register("ika/src/group.js",function(exports,module){var Element=require("ika/src/element.js");var ArrayMgr=require("akirakazu~arraymgr@master");var Transform=require("ika/src/transform.js");var utils=require("ika/src/utils.js");var Query=require("ika/src/query.js");function Group(){Element.call(this);this.name="Group"}Group.prototype=new Element;Group.prototype.init=function(flag){Element.prototype.init.call(this);this.children=new ArrayMgr;this._target=null;this._shouldClip=false;this._getChildrenBound=true;this._transform=new Transform;if(!flag){this.on("mousedown",this.bind("_receiveEvents"));this.on("mouseup",this.bind("_receiveEvents"));this.on("mousemove",this.bind("_receiveEvents"));this.on("mousewheel",this.bind("_receiveEvents"));this.on("mousedrag",this.bind("_receiveEvents"));this.on("mousedragend",this.bind("_receiveEvents"));this.on("click",this.bind("_receiveEvents"))}return this};Group.prototype._receiveEvents=function(event,ctx){var name=event.eventName;var e=event.clone();var r=this.transformPoint(e.x,e.y);e.x=r.x;e.y=r.y;if(name==="mousedrag"||name==="mousedragend"){if(this._target){this._target.emit(name,e)}}else{var item=this._hitTest(e.x,e.y,ctx);if(item){item.emit(name,e)}if(name==="mousedown"){this._target=item}}};Group.prototype.transformPoint=function(x,y){return this._transform.invertPoint(x-this.x,y-this.y)};Group.prototype._hitTest=function(x,y,ctx){var target;this.children.backIterate(function(item){if(!item.visible){return}if(target=item.hitTest(x,y,ctx)){return true}});if(target){return target}};Group.prototype.hitTest=function(x,y,ctx){var np=this.transformPoint(x,y);if(this._hitTest(np.x,np.y,ctx)){return this}};Group.prototype.applyTransform=function(ctx){ctx.translate(this.x,this.y);ctx.transform(this._transform.m[0],this._transform.m[1],this._transform.m[2],this._transform.m[3],this._transform.m[4],this._transform.m[5])};Group.prototype.render=function(ctx,bound){ctx.save();this.applyTransform(ctx);if(this._shouldClip){ctx.save();this.clip(ctx,true)}this.renderBackground(ctx,true);var rerender=false;this.children.iterate(function(child){child._updateAnimation();if(!child.visible){return}if(bound){var cb=child.getBound();if(utils.haveIntersection(bound,cb)){var _bound={x:bound.x-cb.x,y:bound.y-cb.y,width:bound.width,height:bound.height};if(child.render(ctx,_bound)){rerender=true}}}else{if(child.render(ctx)){rerender=true}}});this.renderBorder(ctx,true);if(this._shouldClip){ctx.restore()}ctx.restore();return rerender};Group.prototype.getBound=function(){var width=0,height=0;if(this.visible){if(this._getChildrenBound){this.children.iterate(function(child){var bound=child.getBound();if(width<bound.x+bound.width){width=bound.x+bound.width}if(height<bound.y+bound.height){height=bound.y+bound.height}})}else{width=this.width;
height=this.height}}return{x:this.x,y:this.y,width:width,height:height}};Group.prototype.add=function(item){this.children.add(item)};Group.prototype.rm=function(item){this.children.rm(item)};Group.prototype.getChildPosition=function(item){var pos={x:0,y:0};if(utils.searchItemInGroup(this,item,pos)){var b=item.getBound();pos.x+=b.x;pos.y+=b.y;return pos}else{return null}};Group.prototype.query=function(selector){return new Query(this,selector)};module.exports=Group});require.register("ika/src/groups/scrollbase.js",function(exports,module){var Group=require("ika/src/group.js");var ArrayMgr=require("akirakazu~arraymgr@master");var utils=require("ika/src/utils.js");var Scroller=require("ika/src/elements/scroller.js");var Ease=require("akirakazu~ika-animations@master").Ease;var Friction=require("akirakazu~ika-animations@master").Friction;function Scrollbase(){Group.call(this);this.name="Scrollbase";this.width=400;this.height=300;this.offsetX=0;this.offsetY=0;this.lastMouseDownPoint=null;this.lastOffsetX=0;this.lastOffsetY=0;this.allowXScroll=true;this.allowYScroll=true;this.showXScroller=true;this.showYScroller=true;this.allowFrictionAnimation=true;this.locked=false}Scrollbase.prototype=new Group;Scrollbase.prototype.init=function(){Group.prototype.init.call(this,true);this.mousedragData=new ArrayMgr;this.xScroller=(new Scroller).init().attr("type","horizontal");this.yScroller=(new Scroller).init();this.on("mousedown",this.bind("_bindmousedown"));this.on("mousedrag",this.bind("_bindmousedrag"));this.on("mouseup",this.bind("_bindmouseup"));this.on("mousedragend",this.bind("_bindmousedragend"));this.on("mousewheel",this.bind("_bindmousewheel"));this.on("click",this.bind("_bindclick"));return this};Scrollbase.prototype.resizeScrollers=function(){var _b=this._getBound();this.xScroller.length=-4+this.width*this.width/_b.width;this.yScroller.length=-4+this.height*this.height/_b.height;if(this.xScroller.length>=this.width){this.xScroller.visible=false}else{this.xScroller.visible=true}if(this.yScroller.length>=this.height){this.yScroller.visible=false}else{this.yScroller.visible=true}this.xScroller.y=this.height-this.xScroller.width-2;this.yScroller.x=this.width-this.yScroller.width-2};Scrollbase.prototype.repositionScrollers=function(){var _b=this._getBound();this.xScroller.x=2-this.offsetX*this.width/_b.width;this.yScroller.y=2-this.offsetY*this.height/_b.height;if(this.xScroller.x+this.xScroller.length>this.width-6){this.xScroller.length=this.width-6-this.xScroller.x}if(this.yScroller.y+this.yScroller.length>this.height-6){this.yScroller.length=this.height-6-this.yScroller.y}};Scrollbase.prototype._getBound=function(){var width=0,height=0;this.children.iterate(function(child){var bound=child.getBound();if(width<bound.x+bound.width){width=bound.x+bound.width}if(height<bound.y+bound.height){height=bound.y+bound.height}});return{x:0,y:0,width:width,height:height}};Scrollbase.prototype.getBound=function(){if(this.visible){return{x:this.x,y:this.y,width:this.width,height:this.height}}else{return{x:this.x,y:this.y,width:0,height:0}}};Scrollbase.prototype._bindmousedown=function(event){this.lastMouseDownPoint={x:event.x,y:event.y};this.lastOffsetX=this.offsetX;this.lastOffsetY=this.offsetY;if(this.animations.length()!==0){this.animations.iterate(function(a){a.abort()});this.animations.empty();this._shouldDispatchClickEvents=false}else{this._shouldDispatchClickEvents=true}this.mousedragData.empty()};Scrollbase.prototype._recordMousedragEvent=function(event){this.mousedragData.add({time:Date.now(),x:event.x,y:event.y});if(this.mousedragData.length()>=5){this.mousedragData.rm(this.mousedragData.get(0))}};Scrollbase.prototype._bindmousedrag=function(event){if(this.locked){return}this.xScroller.show();this.yScroller.show();this._recordMousedragEvent(event);var deltaX=event.x-this.lastMouseDownPoint.x;var deltaY=event.y-this.lastMouseDownPoint.y;var x=this.lastOffsetX;var y=this.lastOffsetY;var bound=this._getBound();if(this.allowXScroll){x+=deltaX;if(x>0||bound.width<=this.width){x=x/2}else if(x+bound.width<this.width&&bound.width>=this.width){x=x+(this.width-(x+bound.width))/2}}if(this.allowYScroll){y+=deltaY;if(y>0||bound.height<=this.height){y=y/2}else if(y+bound.height<this.height&&bound.height>=this.height){y=y+(this.height-(y+bound.height))/2}}this.attr("offsetX",x);this.attr("offsetY",y)};Scrollbase.prototype._bindmouseup=function(event){if(this.mousedragData.length()===0){this.lastMouseDownPoint=null;this.xScroller.hide();this.yScroller.hide();var reachX=this.reachBoundary("x");var reachY=this.reachBoundary("y");if(reachX){this.startEaseAnimation("x")}if(reachY){this.startEaseAnimation("y")}}};Scrollbase.prototype._bindmousedragend=function(event){this.lastMouseDownPoint=null;var reachX=this.reachBoundary("x");var reachY=this.reachBoundary("y");if(reachX){this.startEaseAnimation("x")}if(reachY){this.startEaseAnimation("y")}if(this.allowFrictionAnimation){if(!reachX&&this.allowXScroll){this.startFrictionAnimation("x")}if(!reachY&&this.allowYScroll){this.startFrictionAnimation("y")}}};Scrollbase.prototype._bindmousewheel=function(event){if(this.locked){return}var cb=this._getBound();if(this.allowYScroll&&cb.height>this.height&&event.wheelDeltaY){var y=this.offsetY+event.wheelDeltaY*.2;if(y>0){y=0}else if(y<this.height-cb.height){y=this.height-cb.height}this.attr("offsetY",y)}if(this.allowXScroll&&cb.width>this.width&&event.wheelDeltaX){var x=this.offsetX+event.wheelDeltaX*.2;if(x>0){x=0}else if(x<this.width-cb.width){x=this.width-cb.width}this.attr("offsetX",x)}this.xScroller.show();this.yScroller.show();this._lastMousewheelTime=Date.now();if(!this._hideScrollerInterval){var self=this;this._hideScrollerInterval=setInterval(function(){if(Date.now()-self._lastMousewheelTime>=500){self.xScroller.hide();self.yScroller.hide();clearInterval(self._hideScrollerInterval);self._hideScrollerInterval=0}},200)}NotificationReceiver.emit("render",this)};Scrollbase.prototype._bindclick=function(event){if(!this._shouldDispatchClickEvents){return}var e=event.clone();var r=this.transformPoint(e.x,e.y);e.x=r.x;e.y=r.y;e.x-=this.offsetX;e.y-=this.offsetY;var item=this._hitTest(e.x,e.y);if(item){item.emit("click",e)}};Scrollbase.prototype.reachBoundary=function(cor,boundary){cor=cor||"y";var b=cor==="x"?"width":"height";var key="offset"+cor.toUpperCase();boundary=boundary||0;boundary=Math.abs(boundary);var bound=this._getBound();if(this[key]>boundary){return true}else if(this[key]+bound[b]<this[b]-boundary){return true}};Scrollbase.prototype.startEaseAnimation=function(cor,to){cor=cor||"y";var b=cor==="x"?"width":"height";var key="offset"+cor.toUpperCase();var cb=this._getBound();if(cb[b]===0){return}if(typeof to!=="number"){if(this[key]>0){to=0}else if(this[key]+cb[b]<this[b]){if(cb[b]>=this[b]){to=this[b]-cb[b]}else{to=0}}}var ea=new Ease(this[key],to,500,"outExpo");var self=this;ea.on("step",function(value){self[key]=value;self.emit("ease-animation-step",value)});ea.on("end",function(){self[key]=to;self.animations.rm(ea);self.xScroller.hide();self.yScroller.hide();self.emit("ease-animation-end",to)});this.animations.add(ea);this.emit("ease-animation-start",this[key]);ea.animate()};Scrollbase.prototype.render=function(ctx){if(isNaN(this.offsetX)){this.offsetX=this.lastOffsetX||0}if(isNaN(this.offsetY)){this.offsetY=this.lastOffsetY||0}ctx.save();this.applyTransform(ctx);this.renderBackground(ctx,true);this.clip(ctx,true);ctx.save();ctx.translate(Math.round(this.offsetX),Math.round(this.offsetY));var b={x:-Math.round(this.offsetX),y:-Math.round(this.offsetY),width:this.width,height:this.height};var self=this;var rerender=false;this.children.iterate(function(child){child._updateAnimation();if(!child.visible){return}var cb=child.getBound();if(utils.haveIntersection(b,cb)){if(child.render(ctx,b)){rerender=true}}});if(this.showXScroller||this.showYScroller){this.resizeScrollers();this.repositionScrollers()}ctx.restore();this.xScroller._updateAnimation();this.yScroller._updateAnimation();if(this.showXScroller&&this.xScroller.visible){this.xScroller.render(ctx)}if(this.showYScroller&&this.yScroller.visible){this.yScroller.render(ctx)}this.renderBorder(ctx,true);ctx.restore();return rerender};Scrollbase.prototype.getSpeed=function(cor){cor=cor||"y";var vs=[];var self=this;this.mousedragData.iterate(function(d,i){if(i==self.mousedragData.length()-1){return}var dx=self.mousedragData.get(i+1);var v=(dx[cor]-d[cor])/(dx.time-d.time);vs.push(v)});var vsum=0;for(var i=0;i<vs.length;i++){vsum+=vs[i]}var _v;if(vs.length===0){_v=0}else{_v=vsum/vs.length}if(_v>2){_v=2}else if(_v<-2){_v=-2}return _v};Scrollbase.prototype.hitTest=function(x,y){var np=this.transformPoint(x,y);x=np.x;y=np.y;var b=this.getBound();if(utils.isPointInRect(x,y,0,0,b.width,b.height)){return this}};Scrollbase.prototype.startFrictionAnimation=function(cor){cor=cor||"y";var key="offset"+cor.toUpperCase();var v=this.getSpeed(cor);if(Math.abs(v)<=1e-5){return}if(v>3){v=3}else if(v<-3){v=-3}var cb=this._getBound();var fa=new Friction(this[key],v);var self=this;fa.on("step",function(value){self[key]=value;self.emit("friction-animation-step",value);if(self.reachBoundary(cor,this.v*30)){fa.stop()}});fa.on("end",function(){self.animations.rm(fa);if(self.reachBoundary(cor)){self.startEaseAnimation(cor)}else{self.xScroller.hide();self.yScroller.hide()}self.emit("friction-animation-end",self[key])});this.animations.add(fa);this.emit("friction-animation-start",this[key]);fa.animate()};module.exports=Scrollbase});require.register("ika/src/groups/listbase.js",function(exports,module){var Group=require("ika/src/group.js");function Listbase(){Group.call(this);this.name="Listbase";this.type="vertical";this.width=0;this.height=0;this.enableTransition=false;this.widthFixed=false;this.heightFixed=false;this.childMargin=0}Listbase.prototype=new Group;Listbase.prototype.init=function(){Group.prototype.init.call(this);this.children.on("add",this.bind("resize"));this.children.on("rm",this.bind("resize"));this.children.on("moveto",this.bind("resize"));this.children.on("size-changed",this.bind("resize"));this.watchAttr("childMargin",this.bind("resize"));return this};Listbase.prototype.resize=function(){this["_assign_"+this.type]();NotificationReceiver.emit("render",this)};Listbase.prototype.reset=function(){this.children.iterate(function(child){child.x=child.y=0})};Listbase.prototype._assign_vertical=function(){var self=this;var height=0;this.children.iterate(function(child){var bound=child.getBound();if(bound.x!==0||height!==bound.y){if(self.enableTransition){child.animateTo(0,height)}else{child.x=0;child.y=height}}height+=bound.height;height+=self.childMargin});height-=this.childMargin;if(!this.heightFixed){this.height=height}};Listbase.prototype._assign_horizontal=function(){var self=this;var width=0;this.children.iterate(function(child){var bound=child.getBound();if(width!==bound.x||bound.y!==0){if(self.enableTransition){child.animateTo(width,0)}else{child.x=width;child.y=0}}width+=bound.width;width+=self.childMargin});width-=this.childMargin;if(!this.widthFixed){this.width=width}};module.exports=Listbase});require.register("ika/src/groups/swipe.js",function(exports,module){var Ease=require("akirakazu~ika-animations@master").Ease;var utils=require("ika/src/utils.js");var Scrollbase=require("ika/src/groups/scrollbase.js");var Listbase=require("ika/src/groups/listbase.js");function Swipe(){Scrollbase.call(this);this.name="Swipe";this.type="horizontal";this.allowYScroll=false;this.showXScroller=false;this.showYScroller=false;this.allowFrictionAnimation=false;this.playIntervalId=0;this.intervalTime=1e3;this.showSegments=true;this._disableAutoPlay=false;this.widthFixed=true;this.heightFixed=true;this.childMargin=0;this.index=0}Swipe.prototype=new Scrollbase;Swipe.prototype.init=function(){Scrollbase.prototype.init.call(this);this.off("mousewheel");this.on("mousedragend",this.bind("bindmousedragend"));var self=this;this.on("mousedown",function(event){self._disableAutoPlay=true});this.children.on("add",this.bind("resize"));this.children.on("rm",this.bind("resize"));this.children.on("moveto",this.bind("resize"));this.watchAttr("type",function(val){if(val==="horizontal"){self.allowYScroll=false;self.allowXScroll=true}else{self.allowYScroll=true;self.allowXScroll=false}self.resize()});return this};Swipe.prototype.resize=Listbase.prototype.resize;Swipe.prototype._assign_vertical=Listbase.prototype._assign_vertical;Swipe.prototype._assign_horizontal=Listbase.prototype._assign_horizontal;Swipe.prototype.bindmousedragend=function(event){this._disableAutoPlay=false;var cor=this.type==="horizontal"?"x":"y";if(this.reachBoundary(cor)){return}var index;if(this.getSpeed(cor)<=0){index=this.findCurrentItem(false)}else{index=this.findCurrentItem(true)}this.scrollTo(index)};Swipe.prototype.getSpeed=function(cor){cor=cor||"y";var len=this.mousedragData.length();if(len===0){return-1}return this.mousedragData.get(len-1)[cor]-this.mousedragData.get(0)[cor]};Swipe.prototype.scrollTo=function(index){var item=this.children.get(index);if(!item){return}this.index=index;var b=item.getBound();var cor=this.type==="horizontal"?"x":"y";var key="offset"+cor.toUpperCase();var ea=new Ease(this[key],-b[cor],500,"outExpo");var self=this;ea.on("step",function(value){self[key]=value;self.emit("ease-animation-step",value)});ea.on("end",function(){self[key]=-b[cor];self.animations.rm(ea);NotificationReceiver.emit("render",self);self.emit("ease-animation-end",-b[cor])});this.animations.add(ea);this.emit("ease-animation-start",this[key]);ea.animate()};Swipe.prototype.findCurrentItem=function(leftToRight){var self=this;var cor=this.type==="horizontal"?"x":"y";var size=cor==="x"?"width":"height";var key="offset"+cor.toUpperCase();var index;if(leftToRight){this.children.iterate(function(c,i){var b=c.getBound();if(b[cor]+b[size]+self[key]>=0){index=i;return true}})}else{this.children.iterate(function(c,i){var b=c.getBound();if(b[cor]+self[key]>=0){index=i;return true}})}return index};Swipe.prototype._renderSegments=function(ctx){ctx.save();ctx.shadowBlur=2;ctx.shadowColor="rgba(0,0,0,1)";var count=this.children.length();var r=4;var delta=10;var width=count*r*2+(count-1)*delta;var bound=this.getBound();if(this.type==="horizontal"){var x=(bound.width-width)/2;var y=bound.height-delta;for(var i=0;i<count;i++){if(i===this.index){ctx.fillStyle="white"}else{ctx.fillStyle="rgba(255,255,255,0.5)"}ctx.beginPath();ctx.arc(x+i*(r*2+delta),y,r,0,Math.PI*2);ctx.closePath();ctx.fill()}}else{var x=bound.width-delta;var y=(bound.height-width)/2;for(var i=0;i<count;i++){if(i===this.index){ctx.fillStyle="white"}else{ctx.fillStyle="rgba(255,255,255,0.5)"}ctx.beginPath();ctx.arc(x,y+i*(r*2+delta),r,0,Math.PI*2);ctx.closePath();ctx.fill()}}ctx.restore()};Swipe.prototype.render=function(ctx){ctx.save();this.applyTransform(ctx);this.renderBackground(ctx,true);this.clip(ctx,true);ctx.save();ctx.translate(this.offsetX,this.offsetY);var b={x:0,y:0,width:this.width,height:this.height};var self=this;var rerender=false;this.children.iterate(function(child){child._updateAnimation();if(!child.visible){return}var cb=child.getBound();cb.x+=self.offsetX;cb.y+=self.offsetY;if(utils.haveIntersection(b,cb)){if(child.render(ctx)){rerender=true}}});ctx.restore();if(this.showSegments){this._renderSegments(ctx)}this.renderBorder(ctx,true);ctx.restore();return rerender};Swipe.prototype.play=function(){if(this.playIntervalId){return}var self=this;this.playIntervalId=setInterval(function(){if(self._disableAutoPlay){return}if(self.index<self.children.length()-1){self.index++}else{self.index=0}self.scrollTo(self.index)},this.intervalTime)};Swipe.prototype.stop=function(){if(!this.playIntervalId){return}clearInterval(this.playIntervalId);this.playIntervalId=0};module.exports=Swipe});require.register("ika/src/groups/buttonset.js",function(exports,module){var Listbase=require("ika/src/groups/listbase.js");var Button=require("ika/src/elements/button.js");function Buttonset(opts){Listbase.call(this);this.name="Buttonset";this.isInput=true;opts=opts||{};this.values={};this.childMargin=10;this.type="horizontal";this.multiple=opts.multiple||false;this.unselectable=opts.unselectable||false;if(this.multiple){this.unselectable=true}}Buttonset.prototype=new Listbase;Buttonset.prototype._bindEventsForButton=function(button){var self=this;button.on("click",function(){if(self.multiple){if(this.active){this.active=false}else{this.active=true}self.emit("change",self.getValue())}else{var activeButton=self._findActiveButton();if(!activeButton){this.active=true;self.emit("change",self.getValue())}else{if(activeButton===this){if(self.unselectable){this.active=false;self.emit("change",self.getValue())}}else{activeButton.active=false;this.active=true;self.emit("change",self.getValue())}}}NotificationReceiver.emit("render",self)})};Buttonset.prototype._findActiveButton=function(){var _child;this.children.iterate(function(child){if(child.active){_child=child;return true}});return _child};Buttonset.prototype.addButton=function(){for(var i=0;i<arguments.length;i++){var button=new Button(arguments[i]).init();this.children.add(button);this._bindEventsForButton(button);button.css("border-radius",0)}return this};Buttonset.prototype.findButton=function(name){var _child;this.children.iterate(function(child){if(child.value===name){_child=child;return true}});return _child};Buttonset.prototype.rmButton=function(name){var child=this.findButton(name);if(child){this.children.rm(child)}return this};Buttonset.prototype.getValue=function(){var value={};this.children.iterate(function(child){value[child.value]=child.active});return value};Buttonset.prototype.setValue=function(value){for(var k in value){if(value[k]){this.activateButtonByName(k)}}};Buttonset.prototype.reset=function(){this.children.iterate(function(child){child.active=false})};Buttonset.prototype.activateButtonByName=function(name){var button=this.findButton(name);if(button){button.active=true}};Buttonset.prototype.activateButtonAtIndex=function(index){if(index<this.children.length()&&index>=0){this.children.get(index).active=true}};module.exports=Buttonset});require.register("ika/src/groups/stack.js",function(exports,module){var Group=require("ika/src/group.js");var utils=require("ika/src/utils.js");function Stack(){Group.call(this);this.name="Stack";this.width=400;this.height=300;this.type="horizontal";this.transitionType="outExpo";this.index=0;this.enableTransition=true}Stack.prototype=new Group;Stack.prototype.init=function(){Group.prototype.init.call(this);this.children.on("add",this.bind("resize"));this.children.on("rm",this.bind("resize"));this.children.on("moveto",this.bind("resize"));this.watchAttr("width",this.bind("resize"));this.watchAttr("height",this.bind("resize"));return this};Stack.prototype.resize=function(){var self=this;this.children.iterate(function(child,index){var x=0,y=0;if(self.type==="horizontal"){x=(index-self.index)*self.width}else{y=(index-self.index)*self.height}if(self.enableTransition){child.animateTo(x,y,{type:self.transitionType})}else{child.x=x;child.y=y}})};Stack.prototype.render=function(ctx){ctx.save();this.applyTransform(ctx);this.renderBackground(ctx,true);this.clip(ctx,true);var self=this;var bound={x:0,y:0,width:this.width,height:this.height};var rerender=false;this.children.iterate(function(child){child._updateAnimation();if(!child.visible){return}if(utils.haveIntersection(bound,child.getBound())){if(child.render(ctx)){rerender=true}}});this.renderBorder(ctx,true);ctx.restore();return rerender};Stack.prototype.getBound=function(){return{x:this.x,y:this.y,width:this.width,height:this.height}};Stack.prototype.navTo=function(index,fn){fn=fn||function(){};if(this.animations.length()!==0){fn("Existing animation running");return}if(index===this.index){fn("Is current stack");return}if(index>this.children.length()-1){fn("Stack out of range");return}this.index=index;this.resize();NotificationReceiver.emit("render",this);fn(null)};module.exports=Stack});require.register("ika/src/groups/fan.js",function(exports,module){var Group=require("ika/src/group.js");function Fan(){Group.call(this);this.name="Fan";this.startAngel=-Math.PI/2;this.endAngel=Math.PI/2;this.radius=50}Fan.prototype=new Group;Fan.prototype.resize=function(){var length=this.children.length();if(length===0){return}var delta=0;if(length!==1){delta=(this.endAngel-this.startAngel)/(length-1)}var self=this;this.children.iterate(function(child,index){var a=self.startAngel+index*delta;while(a<0){a+=Math.PI*2}while(a>Math.PI*2){a-=Math.PI*2}var x=Math.cos(a)*self.radius;var y=Math.sin(a)*self.radius;child.animateTo(x,y)})};Fan.prototype.reset=function(){this.children.iterate(function(child){child.animateTo(0,0)})};module.exports=Fan});require.register("ika/src/groups/popover.js",function(exports,module){var Group=require("ika/src/group.js");var utils=require("ika/src/utils.js");function Popover(){Group.call(this);this.name="Popover"}Popover.prototype=new Group;Popover.prototype.init=function(){Group.prototype.init.call(this,true);this.css({"border-width":1,"border-color":utils.colorOne,"background-color":"white"});this.on("mousedown",this.bind("onmousedown"));this.on("click",this.bind("_receiveEvents"));this.on("mouseup",this.bind("_receiveEvents"));this.on("mousemove",this.bind("_receiveEvents"));this.on("mousewheel",this.bind("_receiveEvents"));this.on("mousedrag",this.bind("_receiveEvents"));this.on("mousedragend",this.bind("_receiveEvents"));return this};Popover.prototype.hitTest=function(x,y){return this};Popover.prototype.onmousedown=function(event,ctx){var x=event.x,y=event.y;var b=this.getBound();if(!utils.isPointInRect(x,y,b.x,b.y,b.width,b.height)){this.emit("should-hide")}else{this._receiveEvents(event,ctx)}};module.exports=Popover});require.register("ika/src/groups/menu.js",function(exports,module){var Group=require("ika/src/group.js");var Listbase=require("ika/src/groups/listbase.js");var Label=require("ika/src/elements/label.js");var utils=require("ika/src/utils.js");function Menu(){Listbase.call(this);this.name="Menu";this.colorOne=utils.colorOne}Menu.prototype=new Listbase;Menu.prototype.init=function(labelWidth){Listbase.prototype.init.call(this);this.attr("childMargin",5);this.css({color:utils.colorOne,"second-color":utils.colorTwo});this.children.on("add",this.bind("unifyWidth"));this.children.on("rm",this.bind("unifyWidth"));this.children.on("moveto",this.bind("unifyWidth"));this.labelWidth=labelWidth;return this};Menu.prototype.add=function(name,fn){fn=fn||function(){};var self=this;var label=(new Label).init().attr({value:name,autoWidth:true});this._bindEventsForLabel(label,fn);this.children.add(label);return this};Menu.prototype._bindEventsForLabel=function(label,fn){var self=this;label.on("mousemove",function(){self.children.iterate(function(child){child.css({color:self.css("color"),"background-color":"rgba(0, 0, 0, 0)"})});this.css({color:self.css("second-color"),"background-color":self.css("color")})});label.on("mousedown",function(){self.children.iterate(function(child){child.css({color:self.css("color"),"background-color":"rgba(0, 0, 0, 0)"})});this.css({color:self.css("second-color"),"background-color":self.css("color")})});label.on("mousedragend",function(){this.css({color:self.css("color"),"background-color":"rgba(0, 0, 0, 0)"})});label.on("mouseup",function(){this.css({color:self.css("color"),"background-color":"rgba(0, 0, 0, 0)"});fn.apply(label,arguments);self.emit("select",label.attr("value"));NotificationReceiver.emit("hide-popover")});label.on("size-changed",this.bind("unifyWidth"))};Menu.prototype.unifyWidth=function(){var max=0;if(this.labelWidth){max=this.labelWidth}else{this.children.iterate(function(child){var b=child.getBound();if(b.width>max){max=b.width}})}this.children.iterate(function(child){child.attr("width",max)})};Menu.prototype.rm=function(name){var label=this.children.query({value:name});if(label){this.children.rm(label);label.dispose();NotificationReceiver.emit("render",this)}return this};Menu.prototype.empty=function(){this.children.iterate(function(child){child.removeAllListeners()});this.children.empty()};module.exports=Menu});if(typeof exports=="object"){module.exports=require("ika")}else if(typeof define=="function"&&define.amd){define("ika",[],function(){return require("ika")})}else{(this||window)["ika"]=require("ika")}})();